<?php
@session_start( );
include( $Htmledit_Path."/../includes/db.inc.php" );
include( $Htmledit_Path."/../includes/config.php" );
if ( $Htmledit_Tag != "Htmledit" )
{
    exit( );
}
echo "<HTML><HEAD><TITLE>Color</TITLE>\r\n<META content=\"text/html; charset=iso-8859-1\" http-equiv=Content-Type>\r\n<Link rel=\"stylesheet\" type=\"text/css\" href=\"../css/pop.css\">\r\n<STYLE TYPE=\"text/css\">\r\n<!--\r\n td {font-size:9pt}\r\n body {font-size:9pt}\r\n BUTTON {width:5em}\r\n//-->\r\n</STYLE>\r\n\r\n<SCRIPT LANGUAGE=JavaScript>\r\n<!--\r\nvar SelRGB = '';\r\nvar DrRGB = '';\r\nvar SelGRAY = '120';\r\n\r\nvar hexch = new Array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F');\r\n\r\nfunction ToHex(n)\r\n{\r\nvar h, l;\r\nn = Math.round(n);\r\nl = n % 16;\r\nh = Math.floor((n / 16)) % 16;\r\nreturn (hexch[h] + hexch[l]);\r\n}\r\n\r\nfunction DoColor(c, l)\r\n{\r\nvar r, g, b;\r\nr = '0x' + c.substring(1, 3);\r\ng = '0x' + c.substring(3, 5);\r\nb = '0x' + c.substring(5, 7);\r\n  \r\nif(l > 120)\r\n{\r\nl = l - 120;\r\nr = (r * (120 - l) + 255 * l) / 120;\r\ng = (g * (120 - l) + 255 * l) / 120;\r\nb = (b * (120 - l) + 255 * l) / 120;\r\n}\r\nelse\r\n{\r\nr = (r * l) / 120;\r\ng = (g * l) / 120;\r\nb = (b * l) / 120;\r\n}\r\nreturn '#' + ToHex(r) + ToHex(g) + ToHex(b);\r\n}\r\n\r\nfunction EndColor()\r\n{\r\nvar i;\r\nif(DrRGB != SelRGB)\r\n{\r\nDrRGB = SelRGB;\r\nfor(i = 0; i <= 30; i ++)\r\nGrayTable.rows(i).bgColor = DoColor(SelRGB, 240 - i * 8);\r\n}\r\n\r\nSelColor.value = \"\";\r\nif (RGB.innerText!=\"\"){\r\nSelColor.value = DoColor(RGB.innerText, GRAY.innerText);\r\n}\r\nShowColor.bgColor = SelColor.value;\r\n}\r\n//-->\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=ColorTable EVENT=onclick>\r\n  Ok.disabled=false;  //未选定颜色前失效\r\n  SelRGB = event.srcElement.bgColor;\r\n  EndColor();\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=ColorTable EVENT=onmouseover>\r\n  RGB.innerText = event.srcElement.bgColor;\r\n  EndColor();\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=ColorTable EVENT=onmouseout>\r\n  RGB.innerText = SelRGB;\r\n  EndColor();\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=GrayTable EVENT=onclick>\r\n  SelGRAY = event.srcElement.title;\r\n  EndColor();\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=GrayTable EVENT=onmouseover>\r\n  GRAY.innerText = event.srcElement.title;\r\n  EndColor();\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=GrayTable EVENT=onmouseout>\r\n  GRAY.innerText = SelGRAY;\r\n  EndColor();\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=JavaScript FOR=Ok EVENT=onclick>\r\n  window.returnValue = SelColor.value;\r\n  window.close();\r\n</SCRIPT>\r\n</HEAD>\r\n\r\n<BODY bgcolor=\"menu\" scroll=no>\r\n<table border=\"0\" cellspacing=\"10\" cellpadding=\"0\" align=\"center\">\r\n<tr>\r\n<td>\r\n<TABLE ID=ColorTable BORDER=0 CELLSPACING=0 CELLPADDING=0 style='cursor:hand'>\r\n<SCRIPT LANGUAGE=JavaScript>\r\nfunction wc(r, g, b, n)\r\n{\r\nr = ((r * 16 + r) * 3 * (15 - n) + 0x80 * n) / 15;\r\ng = ((g * 16 + g) * 3 * (15 - n) + 0x80 * n) / 15;\r\nb = ((b * 16 + b) * 3 * (15 - n) + 0x80 * n) / 15;\r\ndocument.write('<TD BGCOLOR=#' + ToHex(r) + ToHex(g) + ToHex(b) + ' height=8 width=8></TD>');\r\n}\r\n\r\nvar cnum = new Array(1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0);\r\nfor(i = 0; i < 16; i ++)\r\n{\r\ndocument.write('<TR>');\r\nfor(j = 0; j < 30; j ++)\r\n{\r\nn1 = j % 5;\r\nn2 = Math.floor(j / 5) * 3;\r\nn3 = n2 + 3;\r\nwc((cnum[n3] * n1 + cnum[n2] * (5 - n1)),(cnum[n3 + 1] * n1 + cnum[n2 + 1] * (5 - n1)),(cnum[n3 + 2] * n1 + cnum[n2 + 2] * (5 - n1)), i);\r\n}\r\ndocument.writeln('</TR>');\r\n}\r\n</SCRIPT>\r\n</TABLE>\r\n</td>\r\n<td>\r\n<TABLE ID=GrayTable BORDER=0 CELLSPACING=0 CELLPADDING=0 style='cursor:hand' align=\"center\">\r\n<SCRIPT LANGUAGE=JavaScript>\r\nfor(i = 255; i >= 0; i -= 8.5)\r\ndocument.write('<TR BGCOLOR=#' + ToHex(i) + ToHex(i) + ToHex(i) + '><TD TITLE=' + Math.floor(i * 16 / 17) + ' height=4 width=20></TD></TR>');\r\n</SCRIPT>\r\n</TABLE>\r\n</td>\r\n</tr>\r\n</table>\r\n\r\n<table width=\"250\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"10\">\r\n<tr>\r\n<td>\r\nSelect Color</td>\r\n<td>\r\nOld Color: <SPAN ID=RGB>#</SPAN>\r\n</td>\r\n<td rowspan=\"2\" align=\"right\">\r\n<input ID=Ok type=submit value=Submit disabled>\r\n</td>\r\n</tr>\r\n<tr>\r\n  <td rowspan=\"2\"><table ID=ShowColor border=\"1\" width=\"45\" height=\"40\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tr>\r\n<td>\r\n</td>\r\n</tr>\r\n</table></td>\r\n  <td>Lighteness: <SPAN ID=GRAY>120</SPAN></td>\r\n</tr>\r\n<tr>\r\n  <td>Code: <INPUT TYPE=TEXT SIZE=7 ID=SelColor readonly></td>\r\n<td align=\"right\">\r\n<input type=button value=Close onClick=\"javascript:window.close()\">\r\n</td>\r\n</tr>\r\n</table>\r\n<SCRIPT LANGUAGE=JavaScript>\r\nSelRGB = RGB.innerText;\r\nEndColor();\r\n</SCRIPT>\r\n</BODY>\r\n</HTML>\r\n";
?>
