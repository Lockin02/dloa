<?php
@session_start( );
include( $Htmledit_Path."/../includes/db.inc.php" );
include( $Htmledit_Path."/../includes/config.php" );
if ( $Htmledit_Tag != "Htmledit" )
{
    exit( );
}
echo "<html>\r\n<head>\r\n<title>单元格属性</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\r\n<Link rel=\"stylesheet\" type=\"text/css\" href=\"../css/pop.css\">\r\n<script language=javascript>\r\n\r\n var sInitColor;\r\n\r\n function sImgDlg(){\r\n  res = showModalDialog('sImg.php?langtype=cn', null, 'dialogWidth: 330px; dialogHeight: 225px; center: yes; resizable: no; scroll: no; status: no;');\r\n  if(res == 'lib')\r\n   res = showModalDialog('lib.php?langtype=cn&libtype=image', null, 'dialogWidth: 770px; dialogHeight: 450px; center: yes; resizable: no; scroll: no; status: no;');\r\n  if(res)\r\n   return res;\r\n }\r\n\r\n function callColorDlg(src){\r\n  if(sInitColor == null)\r\n   var sColor = dlgHelper.ChooseColorDlg();\r\n  else\r\n   var sColor = dlgHelper.ChooseColorDlg(sInitColor);\r\n\r\n  sColor = sColor.toString(16);\r\n  if (sColor.length < 6) {\r\n   var sTempString = \"000000\".substring(0,6-sColor.length);\r\n   sColor = sTempString.concat(sColor);\r\n  }\r\n\r\n  document.all[src].style.backgroundColor = '#' + sColor;\r\n  sInitColor = sColor;\r\n }\r\n\r\n window.onload = function(){\r\n  tableForm.cell_width.value = cellWidth;\r\n \ttableForm.cell_height.value = cellHeight;\r\n  tableForm.col_span.value = dialogArguments.colSpan;\r\n  tableForm.row_span.value = dialogArguments.rowSpan;\r\n\r\n  for (i=0; i<tableForm.align.options.length; i++)\r\n \t if(tableForm.align.options[i].text.toLowerCase() == dialogArguments.align.toLowerCase())\r\n    tableForm.align.options[i].selected = true;\r\n\r\n  for (i=0; i<tableForm.valign.options.length; i++)\r\n \t if(tableForm.valign.options[i].text.toLowerCase() == dialogArguments.vAlign.toLowerCase())\r\n    tableForm.valign.options[i].selected = true;\r\n\r\n  if(dialogArguments.bgColor){\r\n   document.all.bgcolor.style.backgroundColor = dialogArguments.bgColor;\r\n   tableForm.bgtype.options[1].selected = true;\r\n  }else if(dialogArguments.background){\r\n   tableForm.bgfile.value = dialogArguments.background;\r\n   tableForm.bgtype.options[2].selected = true;\r\n  }\r\n  sBgType();\r\n \tthis.focus();\r\n }\r\n\r\nvar cellBgColor = dialogArguments.bgColor;\r\nvar cellWidth = dialogArguments.width;\r\nvar cellHeight = dialogArguments.height;\r\nvar cellAlign = dialogArguments.align;\r\nvar cellvAlign = dialogArguments.vAlign;\r\n\r\n function sBgType(){\r\n  switch(tableForm.bgtype.options[tableForm.bgtype.selectedIndex].value){\r\n   case 'none':\r\n    sImage.style.display = 'none';\r\n    sColor.style.display = 'none';\r\n    break;\r\n   case 'color':\r\n    sImage.style.display = 'none';\r\n    sColor.style.display = 'block';\r\n    break;\r\n   case 'image':\r\n    sImage.style.display = 'block';\r\n    sColor.style.display = 'none';\r\n    break;\r\n  }\r\n }\r\n\r\nfunction doModify() {\r\n\tvar error = 0;\r\n\tif (tableForm.cell_width.value < 0) {\r\n\t\talert(\"请填写数字！\")\r\n\t\terror = 1\r\n\t\ttableForm.cell_width.select()\r\n\t\ttableForm.cell_width.focus()\r\n\t}\r\n\r\n\tif (tableForm.cell_height.value < 0) {\r\n\t\talert(\"请填写数字！\")\r\n\t\terror = 1\r\n\t\ttableForm.cell_height.select()\r\n\t\ttableForm.cell_height.focus()\r\n\t}\r\n\r\n\tif(!error){\r\n\r\n\t returnValue = new Object();\r\n  returnValue.width = tableForm.cell_width.value;\r\n  returnValue.height = tableForm.cell_height.value;\r\n  returnValue.colSpan = tableForm.col_span.value;\r\n  returnValue.rowSpan = tableForm.row_span.value;\r\n  returnValue.align = tableForm.align[tableForm.align.selectedIndex].value;\r\n  returnValue.vAlign = tableForm.valign[tableForm.valign.selectedIndex].value;\r\n  switch(tableForm.bgtype.options[tableForm.bgtype.selectedIndex].value){\r\n   case 'color':\r\n    returnValue.bgColor = document.all.bgcolor.style.backgroundColor;\r\n    break;\r\n   case 'image':\r\n    returnValue.background = tableForm.bgfile.value;\r\n    break;\r\n  }\r\n        \r\n  window.close()\r\n\t}\r\n}\r\n\r\n</script>\r\n</head>\r\n<body bgcolor=\"menu\">\r\n<form name=tableForm>\r\n  <table cellspacing=0 cellpadding=10 width=\"100%\">\r\n    <tr>\r\n      <td><fieldset><legend>单元格属性</legend> \r\n        <table cellspacing=0 cellpadding=5>\r\n          <tr> \r\n            <td width=\"77\">单元格背景:</td>\r\n            <td width=\"80\">\r\n              <select name=bgtype onchange=\"sBgType();\">\r\n                <option value=none>透明背景</option>\r\n                <option value=color>背景颜色</option>\r\n                <option value=\"image\">图片背景</option>\r\n              </select>\r\n            </td>\r\n            <td colspan=2 valign=top> \r\n              <div id=sColor style=\"position:absolute; display:none;\"><img src=../images/dot.gif width=30 height=17 border=1 id=bgcolor onclick=\"callColorDlg('bgcolor');\"></div>\r\n              <div id=sImage style=\"position:absolute; display:none;\"><input type=text readonly size=12 name=bgfile><input type=button value=\"选择\" onClick=\"tableForm.bgfile.value = sImgDlg();\"></div>\r\n            </td>\r\n          </tr>\r\n          <tr> \r\n            <td>单元格宽度:</td>\r\n            <td>\r\n              <input type=text name=cell_width size=4 maxlength=4>\r\n            </td>\r\n            <td width=\"76\">单元格高度:</td>\r\n            <td width=\"59\">\r\n              <input type=text name=cell_height size=4 maxlength=4>\r\n            </td>\r\n          </tr>\r\n          <tr> \r\n            <td>左右: \r\n            <input type=hidden name=col_span size=3 maxlength=3></td>\r\n            <td>\r\n              <select name=align>\r\n                <option value=\"None\" selected>默认</option>\r\n                <option value=\"Left\">居左</option>\r\n                <option value=\"Center\">居中</option>\r\n                <option value=\"Right\">居右</option>\r\n              </select>\r\n            </td>\r\n            <td>上下: \r\n            <input type=hidden name=row_span size=3 maxlength=3></td>\r\n            <td>\r\n              <select name=valign>\r\n                <option value=\"None\" selected>默认</option>\r\n                <option value=\"Top\">顶端</option>\r\n                <option value=\"Middle\">中间</option>\r\n                <option value=\"Bottom\">底部</option>\r\n              </select>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n        </fieldset><br>\r\n\t    <input type=button value=\"修改\" onClick=\"javascript:doModify();\">\r\n\t    <input type=button value=取消 onClick=\"javascript:window.close();\">\r\n</td></tr></table>\r\n</form>\r\n<OBJECT id=dlgHelper CLASSID=\"clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b\" width=\"0px\" height=\"0px\"></OBJECT>\r\n</body>\r\n</html>\r\n";
?>
