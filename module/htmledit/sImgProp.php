<?php
@session_start( );
include( $Htmledit_Path."/../includes/db.inc.php" );
include( $Htmledit_Path."/../includes/config.php" );
if ( $Htmledit_Tag != "Htmledit" )
{
    exit( );
}
echo "<html>\r\n<head>\r\n<title>图片属性</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\r\n<Link rel=\"stylesheet\" type=\"text/css\" href=\"../css/pop.css\">\r\n<script language=javascript>\r\n\r\n var sCurrentAling, sInitColor;\r\n\r\n window.onload = function setValues() {\r\n  imageForm.image_width.value = dialogArguments.width;\r\n  imageForm.image_height.value = dialogArguments.height;\r\n  imageForm.border.value = dialogArguments.border ? dialogArguments.border : 0;\r\n  imageForm.alt_tag.value = dialogArguments.alt;\r\n  imageForm.hspace.value = dialogArguments.hspace;\r\n  imageForm.vspace.value = dialogArguments.vspace;\r\n  document.all.bordercolor.style.backgroundColor = dialogArguments.style.borderColor ? dialogArguments.style.borderColor : '#000000';\r\n\r\n  if(dialogArguments.style.position == 'absolute'){\r\n   if(dialogArguments.style.zIndex < 0)\r\n    sCurrentAling = 'behind';\r\n   else\r\n    sCurrentAling = 'over';\r\n  }else{\r\n   switch(dialogArguments.align.toLowerCase()){\r\n    case 'left':\r\n     sCurrentAling = 'left';\r\n     break;\r\n    case 'right':\r\n     sCurrentAling = 'right';\r\n     break;\r\n    default:\r\n     sCurrentAling = 'none';\r\n     break;\r\n   }\r\n  }\r\n  sSetAlign();\r\n }\r\n\r\n function sSetAlign(){\r\n  sImgs = document.all.tags('IMG');\r\n  for(i=0; i<sImgs.length; i++)\r\n   if(sImgs[i].src.match('align_' + sCurrentAling + '.gif'))\r\n    sImgs[i].border = 2;\r\n//   else if(sImgs[i].id = 'bordercolor')\r\n//    sImgs[i].border = 1;\r\n   else\r\n    sImgs[i].border = 0;\r\n }\r\n\r\n function sChangeAlign(param){\r\n  sCurrentAling = param;\r\n  sSetAlign();\r\n }\r\n\r\n function callColorDlg(src){\r\n  if(sInitColor == null)\r\n   var sColor = dlgHelper.ChooseColorDlg();\r\n  else\r\n   var sColor = dlgHelper.ChooseColorDlg(sInitColor);\r\n\r\n  sColor = sColor.toString(16);\r\n  if (sColor.length < 6) {\r\n   var sTempString = \"000000\".substring(0,6-sColor.length);\r\n   sColor = sTempString.concat(sColor);\r\n  }\r\n\r\n  document.all[src].style.backgroundColor = '#' + sColor;\r\n  sInitColor = sColor;\r\n }\r\n\r\n\r\n function doModify() {\r\n  var error = 0;\r\n  if(isNaN(imageForm.image_width.value) || imageForm.image_width.value < 0) {\r\n   alert(\"图片宽度必须填写数字！\");\r\n   error = 1\r\n   imageForm.image_width.select()\r\n   imageForm.image_width.focus()\r\n  }else if(isNaN(imageForm.image_height.value) || imageForm.image_height.value < 0) {\r\n   alert(\"图片高度必须填写数字！\");\r\n   error = 1\r\n   imageForm.image_height.select()\r\n   imageForm.image_height.focus()\r\n  }else if (isNaN(imageForm.border.value) || imageForm.border.value < 0 || imageForm.border.value == \"\") {\r\n   alert(\"边框宽度必须填写数字！\")\r\n   error = 1\r\n   imageForm.border.select()\r\n   imageForm.border.focus()\r\n  }else if (isNaN(imageForm.hspace.value) || imageForm.hspace.value < 0) {\r\n   alert(\"图片横向间距必须填写数字！\")\r\n   error = 1\r\n   imageForm.hspace.select()\r\n   imageForm.hspace.focus()\r\n  }else if (isNaN(imageForm.vspace.value) || imageForm.vspace.value < 0) {\r\n   alert(\"图片纵向间距必须填写数字！\")\r\n   error = 1\r\n   imageForm.vspace.select()\r\n   imageForm.vspace.focus()\r\n  }\r\n\r\n  if(error != 1){\r\n   returnValue = new Object();\r\n   returnValue.style = new Object();\r\n   returnValue.width = imageForm.image_width.value;\r\n   returnValue.height = imageForm.image_height.value\r\n   returnValue.alt = imageForm.alt_tag.value\r\n   returnValue.border = imageForm.border.value\r\n   returnValue.style.borderColor = document.all.bordercolor.style.backgroundColor;\r\n    \r\n   if(imageForm.hspace.value != \"\")\r\n    returnValue.hspace = imageForm.hspace.value\r\n   else\r\n    returnValue.hspace = 0;\r\n\r\n   if(imageForm.vspace.value != \"\")\r\n    returnValue.vspace = imageForm.vspace.value\r\n   else\r\n    returnValue.vspace = 0;\r\n\r\n   switch(sCurrentAling){\r\n    case 'left':\r\n     returnValue.style.position = 'static';\r\n     returnValue.align = 'left';\r\n     break;\r\n    case 'right':\r\n     returnValue.style.position = 'static';\r\n     returnValue.align = 'right';\r\n     break;\r\n    case 'over':\r\n     returnValue.style.position = 'absolute';\r\n     returnValue.style.zIndex = 100;\r\n     break;\r\n    case 'behind':\r\n     returnValue.style.position = 'absolute';\r\n     returnValue.style.zIndex = -100;\r\n     break;\r\n    default:\r\n     returnValue.style.position = 'static';\r\n     returnValue.style.align = '';\r\n   }\r\n\r\n   window.close()\r\n  }else{\r\n   return false;\r\n  }\r\n }\r\n\r\n</script>\r\n</head>\r\n<body bgcolor=\"menu\"><table align=center><tr><td>\r\n<form name=imageForm onsubmit='doModify();'>\r\n        <fieldset><legend>图片位置</legend> <img src=images/align_none.gif vspace=10 hspace=10 onclick='sChangeAlign(\"none\");' width=\"54\" height=\"55\"> \r\n        <img src=images/align_left.gif vspace=10 hspace=10 onclick='sChangeAlign(\"left\");' width=\"54\" height=\"55\"> \r\n        <img src=images/align_right.gif vspace=10 hspace=10 onclick='sChangeAlign(\"right\");' width=\"54\" height=\"55\"> \r\n        <img src=images/align_over.gif vspace=10 hspace=10 onclick='sChangeAlign(\"over\");' width=\"54\" height=\"55\"> \r\n        <!-- img src=../img/align_behind.gif vspace=10 hspace=10 onclick='sChangeAlign(\"behind\");' --> \r\n        </fieldset> <fieldset><legend>其他属性</legend> \r\n        <table>\r\n <tr>\r\n            <td class=t1>ALT文字:</td>\r\n            <td colspan=3><input type=text name=alt_tag size=41></td></tr>\r\n <tr>\r\n            <td class=t1>图片宽度:</td>\r\n            <td>\r\n              <input type=text name=image_width size=3 maxlength=4>\r\n            </td>\r\n            <td class=t1>图片高度:</td>\r\n            <td>\r\n              <input type=text name=image_height size=3 maxlength=4>\r\n            </td></tr>\r\n <tr>\r\n            <td class=t1>横向间距:</td>\r\n            <td>\r\n              <input type=text name=hspace size=3 maxlength=4>\r\n            </td>\r\n            <td class=t1>纵向间距:</td>\r\n            <td>\r\n              <input type=text name=vspace size=3 maxlength=4>\r\n            </td></tr>\r\n <tr>\r\n            <td class=t1>外框宽度:</td>\r\n            <td>\r\n              <input type=text name=border size=3 maxlength=4>\r\n            </td>\r\n            <td class=t1>外框颜色:</td>\r\n            <td><img src=images/dot.gif width=30 height=17 id=bordercolor onclick=\"callColorDlg('bordercolor');\"></td>\r\n          </tr>\r\n</table>\r\n</fieldset><br>\r\n        <input type=button onclick=\"doModify();\" value=\"确定\">\r\n         \r\n        <input type=button value=\"取消\" onClick=\"self.close();\">\r\n</form></td></tr></table>\r\n<object id=dlgHelper CLASSID=\"clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b\" width=\"0px\" height=\"0px\"></OBJECT>\r\n</body>\r\n</html>";
?>
