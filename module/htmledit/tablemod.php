<?php
@session_start( );
include( $Htmledit_Path."/../includes/db.inc.php" );
include( $Htmledit_Path."/../includes/config.php" );
if ( $Htmledit_Tag != "Htmledit" )
{
    exit( );
}
echo "<html>\r\n<head>\r\n<title>表格属性</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\r\n<Link rel=\"stylesheet\" type=\"text/css\" href=\"../css/pop.css\">\r\n<script language=javascript>\r\n\r\n var sInitColor;\r\n\r\n function callColorDlg(src){\r\n  if(sInitColor == null)\r\n   var sColor = dlgHelper.ChooseColorDlg();\r\n  else\r\n   var sColor = dlgHelper.ChooseColorDlg(sInitColor);\r\n\r\n  sColor = sColor.toString(16);\r\n  if (sColor.length < 6) {\r\n   var sTempString = \"000000\".substring(0,6-sColor.length);\r\n   sColor = sTempString.concat(sColor);\r\n  }\r\n\r\n  document.all[src].style.backgroundColor = '#' + sColor;\r\n  sInitColor = sColor;\r\n }\r\n\r\n function sImgDlg(){\r\n  res = showModalDialog('sImg.php?langtype=cn', null, 'dialogWidth: 330px; dialogHeight: 225px; center: yes; resizable: no; scroll: no; status: no;');\r\n  if(res == 'lib')\r\n   res = showModalDialog('lib.php?langtype=cn&libtype=image', null, 'dialogWidth: 770px; dialogHeight: 450px; center: yes; resizable: no; scroll: no; status: no;');\r\n  if(res)\r\n   return res;\r\n }\r\n\r\n onload = function() {\r\n \ttableForm.table_padding.value = dialogArguments.cellPadding == \"\" ? 1 : dialogArguments.cellPadding;\r\n \ttableForm.table_spacing.value = dialogArguments.cellSpacing == \"\" ? 2 : dialogArguments.cellSpacing;\r\n \ttableForm.table_border.value = dialogArguments.border ? dialogArguments.border : 0;\r\n \ttableForm.table_width.value = dialogArguments.width ? dialogArguments.width : \"\";\r\n\r\n  if(dialogArguments.bgColor){\r\n   document.all.bgcolor.style.backgroundColor = dialogArguments.bgColor;\r\n   tableForm.bgtype.options[1].selected = true;\r\n  }else if(dialogArguments.background){\r\n   tableForm.bgfile.value = dialogArguments.background;\r\n   tableForm.bgtype.options[2].selected = true;\r\n  }\r\n  sBgType();\r\n }\r\n\r\n function sBgType(){\r\n  switch(tableForm.bgtype.options[tableForm.bgtype.selectedIndex].value){\r\n   case 'none':\r\n    sImage.style.display = 'none';\r\n    sColor.style.display = 'none';\r\n    break;\r\n   case 'color':\r\n    sImage.style.display = 'none';\r\n    sColor.style.display = 'block';\r\n    break;\r\n   case 'image':\r\n    sImage.style.display = 'block';\r\n    sColor.style.display = 'none';\r\n    break;\r\n  }\r\n }\r\n\r\n function doModify() {\r\n \tvar error = 0;\r\n \tif (isNaN(tableForm.table_padding.value) || tableForm.table_padding.value < 0 || tableForm.table_padding.value == \"\") {\r\n \t\talert(\"请填写数字！\")\r\n \t\terror = 1\r\n\t \ttableForm.table_padding.select()\r\n\t \ttableForm.table_padding.focus()\r\n\t } else if (isNaN(tableForm.table_spacing.value) || tableForm.table_spacing.value < 0 || tableForm.table_spacing.value == \"\") {\r\n\t\t alert(\"请填写数字！\")\r\n\t\t error = 1\r\n\t\t tableForm.table_spacing.select()\r\n\t\t tableForm.table_spacing.focus()\r\n\t } else if (isNaN(tableForm.table_border.value) || tableForm.table_border.value < 0 || tableForm.table_border.value == \"\") {\r\n \t\talert(\"请填写数字！\")\r\n\t \terror = 1\r\n\t\t tableForm.table_border.select()\r\n\t\t tableForm.table_border.focus()\r\n\t }\r\n\r\n\t if(!error){\r\n\t  returnValue = new Object();\r\n   returnValue.cellPadding = tableForm.table_padding.value;\r\n   returnValue.cellSpacing = tableForm.table_spacing.value;\r\n   returnValue.border = tableForm.table_border.value;\r\n   returnValue.width = tableForm.table_width.value;\r\n   if(tableForm.table_columns)\r\n    returnValue.columns = tableForm.table_columns.value;\r\n   if(tableForm.table_rows)\r\n    returnValue.rows = tableForm.table_rows.value;\r\n   switch(tableForm.bgtype.options[tableForm.bgtype.selectedIndex].value){\r\n    case 'color':\r\n     returnValue.bgColor = document.all.bgcolor.style.backgroundColor;\r\n     break;\r\n    case 'image':\r\n     returnValue.background = tableForm.bgfile.value;\r\n     break;\r\n   }\r\n   window.close()\r\n\t }\r\n }\r\n\r\n</script>\r\n</head>\r\n<body bgcolor=\"menu\">\r\n<form name=tableForm>\r\n<table cellspacing=0 cellpadding=10 width=100%>\r\n<tr>\r\n      <td align=\"center\"><fieldset><legend><span class=\"title\">表格属性</span></legend> \r\n          <table cellspacing=0 cellpadding=5 width=100%>\r\n  <tr>\r\n            <td width=\"34%\">背景颜色:</td>\r\n            <td width=\"21%\">\r\n<select name=bgtype onchange=\"sBgType();\"><option value=none>透明背景</option><option value=color>背景颜色</option>\r\n  <option value=\"image\">图片背景</option>\r\n</select></td>\r\n\t\t    <td colspan=2 valign=top>\r\n\t\t     <div id=sColor style=\"position:absolute; display:none;\"><img src=../images/dot.gif width=30 height=17 border=1 id=bgcolor onclick=\"callColorDlg('bgcolor');\"></div>\r\n\t\t     <div id=sImage style=\"position:absolute; display:none;\"><input type=text readonly size=12 name=bgfile> <input type=button value=\"选择\" onClick=\"tableForm.bgfile.value = sImgDlg();\"></div>\r\n\t\t    </td></tr>\r\n\t\t<tr>\r\n            <td width=\"34%\">单元格间距:</td>\r\n            <td width=\"21%\">\r\n<input type=text name=table_padding size=7 maxlength=2></td>\r\n\t\t    <td width=\"34%\">单元格边距:</td>\r\n            <td width=\"11%\">\r\n<input type=text name=table_spacing size=7 value=2 maxlength=2></td></tr>\r\n\t\t<tr>\r\n            <td width=\"34%\">表格边框:</td>\r\n            <td width=\"21%\">\r\n<input type=text name=table_border size=7 value=1 maxlength=2></td>\r\n            <td width=\"34%\">表格宽度:</td>\r\n            <td width=\"11%\">\r\n              <input type=text name=table_width size=7 maxlength=4>\r\n            </td></tr>\r\n\t\t</table></fieldset><br><script> document.write('<input type=button value=\"修改\" onClick=\"javascript:doModify();\">'); </script> \r\n        <input type=button value=取消 onClick=\"javascript:window.close()\"></td>\r\n</tr></table>\r\n</form>\r\n<OBJECT id=dlgHelper CLASSID=\"clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b\" width=\"0px\" height=\"0px\"></OBJECT>\r\n</body>\r\n</html>\r\n";
?>
