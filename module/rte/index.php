<?php
echo "<html>\r\n<head>\r\n<title>发布公告通知</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"../../inc/style.css\">\r\n\r\n<html>\r\n<head>\r\n<meta content=\"HTML 4.0\" name=\"vs_targetSchema\">\r\n<link rel=\"StyleSheet\" type=\"text/css\" href=\"richedit.css\">\r\n<link rel=\"StyleSheet\" type=\"text/css\" href=\"syntax.css\">\r\n<link rel=\"StyleSheet\" type=\"text/css\" href=\"custom.css\">\r\n<script language=\"JavaScript\" src=\"rte_xhtml.js\"></script>\r\n<script language=\"JavaScript\" src=\"rte_interface.js\"></script>\r\n<script language=\"JavaScript\" src=\"rte_debug.js\"></script>\r\n<script language=\"JavaScript\" src=\"rte.js\"></script>\r\n<script language=\"JavaScript\" src=\"rte_codesweep.js\"></script>\r\n<script language=\"JavaScript\" src=\"rte_editmode.js\"></script>\r\n<script language=\"JavaScript\" src=\"rte_history.js\"></script>\r\n<SCRIPT language=\"JavaScript\" src=\"tableEditor.js\"></SCRIPT>\r\n<script language=\"JavaScript\">\r\nif (window.Event)\r\n  document.captureEvents(Event.MOUSEUP);\r\n\r\nfunction isControlSelected(tag){\r\n\tif (document.selection.type == \"Control\") {\r\n\t\tvar oControlRange = document.selection.createRange();\r\n\t\tif (oControlRange(0).tagName.toUpperCase() == tag) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction ControlSelectedType(){\r\n\r\n\tif (document.selection.type == \"Control\") {\r\n\t     var oControlRange = document.selection.createRange();\r\n\t     return oControlRange(0).type.toUpperCase();\r\n\t}\r\n}\r\n\r\nfunction ControlSelectedClass(){\r\n\r\n\tif (document.selection.type == \"Control\") {\r\n\t     var oControlRange = document.selection.createRange();\r\n\t     return oControlRange(0).className;\r\n\t}\r\n}\r\n\r\n// 菜单常量\r\nvar sMenu1=\"<TABLE class=Menu width=150 border=0 cellpadding=0 cellspacing=0>\";\r\nvar sMenu2=\"</TABLE>\";\r\nvar sMenuHr=\"<tr><td align=center valign=middle height=1 class=HrShadow></td></tr><tr><td align=center valign=middle height=1 class=HrHighLight></td></tr>\";\r\n\r\n// 菜单\r\nvar oPopupMenu = null;\r\noPopupMenu = window.createPopup();\r\n\r\n// 取菜单行\r\nfunction getMenuRow(s_Disabled, s_Event, s_Html) {\r\n\tvar s_MenuRow = \"\";\r\n\ts_MenuRow = \"<tr \"+s_Disabled+\"><td valign=middle height=20 class=RightBg onMouseOver=this.className='MouseOver'; onMouseOut=this.className='MouseOut';\";\r\n\tif (s_Disabled==\"\")\r\n\t{\r\n\t\ts_MenuRow += \" onclick=\\\"parent.\"+s_Event+\";parent.oPopupMenu.hide();\\\"\";\r\n\t}\r\n\ts_MenuRow += \">\";\r\n\r\n\tif(s_Html==\"复制\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=images/icon_copy.gif>\";\r\n\telse if(s_Html==\"剪切\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=images/icon_cut.gif>\";\r\n\telse if(s_Html==\"粘贴\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=images/icon_paste.gif>\";\r\n\telse if(s_Html==\"删除\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=images/icon_delete.gif>\";\r\n\telse if(s_Html==\"全选\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=images/icon_select_all.gif>\";\r\n\telse if(s_Html==\"图片属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=images/icon_ins_image.gif>\";\r\n\telse if(s_Html==\"单选框属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/checkbox.gif>\";\r\n\telse if(s_Html==\"单行输入框属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/textfield.gif>\";\r\n\telse if(s_Html==\"多行输入框属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/textarea.gif>\";\r\n\telse if(s_Html==\"下拉菜单属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/listmenu.gif>\";\r\n\telse if(s_Html==\"日期控件属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/calendar.gif>\";\r\n\telse if(s_Html==\"宏控件属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/auto.gif>\";\r\n\telse if(s_Html==\"计算控件属性...\")\r\n\t   s_MenuRow +=\"<img border=0 width=20 height=20 align=absmiddle src=/images/form/calc.gif>\";\r\n\r\n\ts_MenuRow += \"&nbsp;\"+s_Html+\"</td></tr>\";\r\n\treturn s_MenuRow;\r\n\r\n}\r\n\r\n// 格式化编辑器中的内容，并执行\r\nfunction format(what,opt) {\r\n\tif(!RichEditor.txtView) return;\r\n\tif (opt==\"RemoveFormat\") {\r\n\t\twhat=opt;\r\n\t\topt=null;\r\n\t}\r\n\tif (opt==null) document.execCommand(what);\r\n\telse document.execCommand(what,\"\",opt);\r\n\treset();\r\n}\r\n\r\n// 取标准的format菜单行\r\nfunction getFormatMenuRow(menu, html){\r\n\tvar s_Disabled = \"\";\r\n\tif (!document.queryCommandEnabled(menu)){\r\n\t\ts_Disabled = \"disabled\";\r\n\t}\r\n\tvar s_Event = \"format('\"+menu+\"')\";\r\n\treturn getMenuRow(s_Disabled, s_Event,  html)\r\n}\r\n\r\n// 显示无模式对话框\r\nfunction ShowDialog(url, width, height) {\r\n\r\n\tvar arr = showModalDialog(url, window, \"dialogWidth:\" + width + \"px;dialogHeight:\" + height + \"px;help:no;scroll:yes;resizable:1;status:no\");\r\n}\r\n\r\nfunction showContextMenu(event)\r\n{\r\n\tif (switchMode.checked) return false;\r\n\r\n\tvar width = 150;\r\n\tvar height = 0;\r\n\tvar lefter = event.clientX;\r\n\tvar topper = event.clientY;\r\n\r\n\tvar oPopDocument = oPopupMenu.document;\r\n\tvar oPopBody = oPopupMenu.document.body;\r\n\r\n\tvar sMenu=\"\";\r\n\r\n\tsMenu += getFormatMenuRow(\"cut\", \"剪切\");\r\n\tsMenu += getFormatMenuRow(\"copy\", \"复制\");\r\n\tsMenu += getFormatMenuRow(\"paste\", \"粘贴\");\r\n\tsMenu += getFormatMenuRow(\"delete\", \"删除\");\r\n\tsMenu += getFormatMenuRow(\"selectall\", \"全选\");\r\n\tsMenu += sMenuHr;\r\n\theight += 100;\r\n\r\n\tif (isControlSelected(\"IMG\"))\r\n\t{\r\n\r\n\t\tif(ControlSelectedClass()!=\"DATE\")\r\n\t\t   sMenu += getMenuRow(\"\", \"insert('image')\", \"图片属性...\");\r\n\t\telse\r\n\t\t   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/calendar.php',320,80)\", \"日期控件属性...\");\r\n\t\tsMenu += sMenuHr;\r\n\t\theight += 22;\r\n\t}\r\n\telse if (isControlSelected(\"INPUT\"))\r\n\t{\r\n\t\tif(ControlSelectedType()==\"CHECKBOX\")\r\n\t\t   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/checkbox.php',320,112)\", \"单选框属性...\");\r\n\t\telse if(ControlSelectedClass()==\"AUTO\")\r\n\t\t   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/auto.php',360,210)\", \"宏控件属性...\");\r\n\t\telse if(ControlSelectedClass()==\"CALC\")\r\n\t\t   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/calc.php',320,172)\", \"计算控件属性...\");\r\n\t\telse\r\n                   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/textfield.php',320,140)\", \"单行输入框属性...\");\r\n\r\n\t\tsMenu += sMenuHr;\r\n\t\theight += 22;\r\n\t}\r\n\telse if (isControlSelected(\"TEXTAREA\"))\r\n\t{\r\n\t\tsMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/textarea.php',320,140)\", \"多行输入框属性...\");\r\n\t\tsMenu += sMenuHr;\r\n\t\theight += 22;\r\n\t}\r\n\telse if (isControlSelected(\"SELECT\"))\r\n\t{\r\n\t\tif(ControlSelectedClass()!=\"AUTO\")\r\n\t\t   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/listmenu.php',320,293)\", \"下拉菜单属性...\");\r\n\t\telse\r\n\t\t   sMenu += getMenuRow(\"\", \"ShowDialog('../../general/system/workflow/flow_form/cool_form/auto.php',320,210)\", \"宏控件属性...\");\r\n\t\tsMenu += sMenuHr;\r\n\t\theight += 22;\r\n\t}\r\n\r\n\tsMenu = sMenu1 + sMenu + sMenu2;\r\n\r\n\toPopDocument.open();\r\n\toPopDocument.write(\"<head><link href=\\\"MenuArea.css\\\" type=\\\"text/css\\\" rel=\\\"stylesheet\\\"></head><body scroll=\\\"no\\\" onConTextMenu=\\\"event.returnV	?>
