<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=gbk"/>
        <title>OA</title>
        <link rel="stylesheet" href="js/thickbox.css" type="text/css" media="screen" />
        <link rel="stylesheet" type="text/css" href="js/jqeasyui/themes/default/easyui.css"/>
        <link rel="stylesheet" type="text/css" href="js/jqeasyui/themes/icon.css"/>
        <script type="text/javascript" src="js/jqeasyui/jquery.min.js"></script>
        <script type="text/javascript" src="js/jqeasyui/jquery.easyui.min.js"></script>
        <script type="text/javascript" src="js/jqeasyui/locale/easyui-lang-zh_CN.js"></script>
        <script type="text/javascript" src="js/thickbox.js"></script>
        <script type="text/javascript">
            $(function(){
                $('#test').datagrid({
                    fit:true,
                    nowrap: true,
                    striped: true,
                    collapsible:true,
                    url:'?model=module_report&action=data&kid=d4b019f578a3e77e2dabdb336ccc7743',
                    sortName: 'name',
                    sortOrder: 'asc',
                    remoteSort: false,
                    idField:'name',
                    columns:[[
                            {field:'name',title:'报表名称',width:200},
                            {field:'srows',title:'锁定行',width:40},
                            {field:'scols',title:'锁定列',width:40},
                            {field:'addr',title:'地址',width:550
                                ,formatter:function(value , row , index){
                                    var e='?model=module_report&action=list&reportkey='+row.kid;
                                    return e;
                                }},
                            {field:'kid',title:'操作',width:150
                                ,formatter:function(value,row,index){
                                    var e = '<a href="#" onclick="tb_show(\''+row.name
                                        +'-> 修改\', \'?model=module_report&action=add&reportkey='+row.kid+'&TB_iframe=true&height=650&width=900\')">修改</a> | '
                                        +'<a href="#" onclick="repShow(\''+row.kid+'\')">浏览</a>';  
                                    return e; 
                                }}
                        ]],
                    pagination:true,
                    pageList:[50,30,20],
                    rownumbers:true
                });
            });
            function repShow(kid){
                window.open('?model=module_report&action=list&reportkey='+kid);
            }
            function addList(){
                tb_show('添加报表','?model=module_report&action=add&TB_iframe=true&height=650&width=900');
            }
        </script>
        <style type="text/css">
        </style>
    </head>
    <body id="tabdiv" class="easyui-layout" border="false">
        <div region="north" border="false" 
             style="height:28px;padding-left: 5px;padding-top: 1px;background:#fafafa;overflow: hidden">
            <div style="float:left;">
                <a href="#" class="easyui-linkbutton" plain="true" icon="icon-add" onclick="addList()">新增</a>
            </div>
        </div>
        <div region="center" border="true" >
            <table id="test" border="false" cellpadding="0" cellspacing="0"></table> 
        </div>
    </body>
</html>