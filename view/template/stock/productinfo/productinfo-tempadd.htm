<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Language" content="zh_cn" />
<meta name="GENERATOR" content="Zend Studio" />
<meta http-equiv="Content-Type" content="text/html; charset=GB2312" />
<link rel="stylesheet" href="css/yxstyle.css" type="text/css"
	media="screen" />
<link rel="stylesheet" type="text/css"
	href="js/jquery/style/Validator.css" />
<link rel="stylesheet" href="js/jquery/style/yxtree.css" type="text/css" />
<link type="text/css" href="js/jquery/style/yxmenu.css" media="screen"
	rel="stylesheet" />
<link rel="stylesheet" type="text/css"
	href="js/jquery/style/yxmenu.theme.css" media="screen" />
<link rel="stylesheet" type="text/css" href="js/jquery/style/yxgrid.css" />
<!-- 主题css，可切换 -->
<link type="text/css" href="js/jquery/style/yxmenu.theme.css"
	media="screen" rel="stylesheet" />
<script type="text/javascript" src="js/jquery/jquery-1.4.2.js"></script>
<script type="text/javascript" src="js/common/businesspage.js"></script>
<script type="text/javascript" src="js/jquery/woo.js"></script>
<script type="text/javascript" src="js/jquery/component.js"></script>
<script type="text/javascript" src="js/jquery/combo/yxcombo.js"></script>
<script type="text/javascript" src="js/jquery/ztree/yxtree.js"></script>
<script type="text/javascript" src="js/jquery/combo/yxcombotree.js"></script>
<script type="text/javascript" src="js/jquery/grid/yxsgrid.js"> </script>
<script type="text/javascript" src="js/jquery/grid/yxgrid.js"> </script>
<script type="text/javascript" src="js/jquery/combo/yxcombogrid.js"> </script>
<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-stockinfo.js"> </script>
<script type="text/javascript" src="js/jquery/formValidator.js" charset="UTF-8"> </script>
<script type="text/javascript" src="js/jquery/formValidatorRegex.js" charset="UTF-8"></script>
<script type="text/javascript" src="view/template/stock/productinfo/js/producttype-info-combotree.js"></script>
<script type="text/javascript" src="view/template/stock/productinfo/js/productinfo-stockinfo-combogrid.js"></script>
<title>新增物料</title>
</head>
<body>
<div class="main_head"><span class="main_head_title">
物料基本信息 </span></div>
<form id="form1" action="?model=stock_productinfo_productinfo&action=tempProadd" method="post" >
<table class='form_main_table' id="edit">
	<tr id="tr_sort">
		<td class="form_text_left">物料类型</td>
		<td class="form_text_right">
		 <input type="text" class="txt" id="proType" name="productinfo[proType]"/>
		 <input type="hidden" id="proTypeId" name="productinfo[proTypeId]" />
		 <span class="red">[*]</span>
		 <div id="proTypeIdTip" class="tipShortTxt"></div>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">物料编号</td>
		<td class="form_text_right"><input type="text" class="txt"
			id="productCode" name="productinfo[productCode]" /> <span
			class="red">[*]</span>
		<div id="productCodeTip"></div>
		</td>
		<td class="form_text_left">物料名称</td>
		<td class="form_text_right">
		  <input type="text" class="txt" id="productName" name="productinfo[productName]" class="required" value="{productName}"/>
		<span class="red">[*]</span>
		<div id="productNameTip"></div>
		</td>

	</tr>
	<tr>
		<!--
		<td class="form_text_left">单价</td>
		<td class="form_text_right"><input type="text" class="txt"
			id="priCost" name="productinfo[priCost]"
			onkeypress="return event.keyCode&gt;=48&amp;&amp;event.keyCode&lt;=57">
		</td>
	 -->
		<td class="form_text_left">单位</td>
		<td class="form_text_right"><input type="text" class="txt"
			name="productinfo[unitName]" /></td>
		<td class="form_text_left">辅助单位</td>
		<td class="form_text_right"><input type="text" class="txt"
			name="productinfo[aidUnit]" /></td>
	</tr>
	<tr>
		<td class="form_text_left">换算率</td>
		<td class="form_text_right"><input type="text" class="txt"
			name="productinfo[converRate]" /></td>
	</tr>
	<tr>
		<td class="form_text_left">型号/版本号</td>
		<td class="form_text_right">
		    <input type="text" class="txt" id="pattern" name="productinfo[pattern]" value="{productModel}"/>
		</td>
		<td class="form_text_left">质检方式</td>
		<td class="form_text_right"><select class="select"
			name="productinfo[checkType]">
			{checkType}
		</select></td>
	</tr>
	<tr>
		<td class="form_text_left">到货周期(月)</td>
		<td class="form_text_right"><input type="text" class="txt"
			id="priCost" name="productinfo[arrivalPeriod]" >
		</td>
		<td class="form_text_left">保修期(月)</td>
		<td class="form_text_right">
		   <input type="text" class="txt" id="remark" name="productinfo[warranty]"></input>
	   </td>
	</tr>

	<tr>
		<td class="form_text_left">会计科目代码</td>
		<td class="form_text_right"><select class="select"
			name="productinfo[accountingCode]">
			{accountingCode}
		</select></td>

		<td class="form_text_left">物料属性</td>
		<td class="form_text_right"><select class="select"
			name="productinfo[properties]">
			{properties}
		</select></td>
	</tr>

	<tr>
		<td class="form_text_left">默认仓库代码</td>
		<td class="form_text_right"><input type="text" id="stockCode"
			class="txt" name="productinfo[stockCode]" /> <input type="hidden"
			id="stockId" name="productinfo[stockId]" /></td>
		<td class="form_text_left">默认仓库名称</td>
		<td class="form_text_right"><input type="text" id="stockName"
			class="readOnlyTxtNormal" name="productinfo[stockName]" /></td>
	</tr>
	<tr>
		<td class="form_text_left">厂家信息</td>
		<td class="form_text_right" colspan="3"><input type="text"
			class="txt" style="width: 630;" name="productinfo[supplier]" /></td>
	</tr>

	<tr>
		<td class="form_text_left">备注</td>
		<td class="form_text_right" colspan="3"><textarea
			class="txt_txtarea_font" id="remark" name="productinfo[remark]"></textarea>
		</td>
	</tr>
</table>
<table id="itemtable" class='form_main_table'>
	<tr>
		<td colspan="4" align="left" class="">&nbsp; 物料配置清单:</td>
		<td align="center" width="5%">
		   <input type="hidden" id="coutNumb" name="coutNumb" value="1" />
           <img src="images/collapsed.gif" onclick="add();" title="添加行" />
        </td>
	</tr>
	<tr class="main_tr_header">
		<th>配置名称</th>
		<th>型号</th>
		<th>数量</th>
		<th>说明</th>
		<th>删除</th>
	</tr>
	<tr>
		<td>
		  <input type="text" class="txt" name="productinfo[configurations][0][configName]" />
		</td>
		<td>
		  <input type="text" class="txtshort" name="productinfo[configurations][0][configPattern]" />
		</td>
		<td>
		   <input type="text" class="txtshort" name="productinfo[configurations][0][configNum]"
		      onkeypress="return event.keyCode&gt;=48&amp;&amp;event.keyCode&lt;=57" />
		</td>
		<td>
		  <input type="text" class="txt" name="productinfo[configurations][0][explains]" />
		</td>
		<td><img src="images/closeDiv.gif" onclick='mydel(this);' title="删除行" /></td>
	</tr>
</table>
<table class="form_main_table">
	<tr>
		<td colspan="5">
           <input type="hidden" name="productinfo[tempId]" value="{id}"/>
           <input type="hidden" name="productinfo[type]" value="{type}" />
		   <input type="submit" class="txt_btn_a" value=" 保 存 "/>
		   <input type="button" class="txt_btn_a" value=" 返 回 " onclick="closeFun();"/>
		</td>
	</tr>
</table>
</form>
</body>
</html>
<script type="text/javascript">

$(document).ready(function() {
    $.formValidator.initConfig({
    	formid: "form1",
        //autotip: true,
        onerror: function(msg) {
        }
    });

	/** 验证物料编号 * */
	$("#productCode").formValidator({
		onshow : "请输入物料编号",
		onfocus : "物料编号不能为空",
		oncorrect : "物料编号有效"
	}).inputValidator({
		min : 1,
		max : 50,
		onerror : "物料编号不能为空，请重新输入"
	}).ajaxValidator({
		type : "get",
		url : "index1.php",
		data : "model=stock_productinfo_productinfo&action=checkProInfo",
		datatype : "json",
		success : function(data) {
			if (data == "1") {
				return true;
			} else {
				return false;
			}
		},
		buttons : $("#submitSave"),
		error : function() {
			alert("服务器没有返回数据，可能服务器忙，请重试");
		},
		onerror : "该物料编号已重复，请更换",
		onwait : "正在对物料编号进行合法性校验，请稍候..."
	});

	/** 验证物料名称 * */
	$("#productName").formValidator({
		onshow : "请输入物料名称",
		onfocus : "物料名称不能为空",
		oncorrect : "物料名称有效"
		}).inputValidator({
			min : 1,
			max : 50,
			onerror : "物料名称不能为空，请重新输入"
 });
	/** 验证物料类型 * */
	$("#proTypeId").formValidator({
		onshow : "请选择物料类型",
		onfocus : "物料类型不能为空",
		oncorrect : "物料类型有效"
		}).inputValidator({
			min : 1,
			max : 50,
			onerror : "物料类型不能为空，请重新输入"
 });

})




/**
 * 动态添加从表数据
 */
			function add() {
				mycount = document.getElementById("coutNumb").value * 1 + 1;
				var itemtable = document.getElementById("itemtable");
				i = itemtable.rows.length;
				oTR = itemtable.insertRow([i]);
				oTR.align = "center";
				oTL1 = oTR.insertCell([0]);

				oTL1.innerHTML = '<input type="text" class="txt" value="" name="productinfo[configurations][' + mycount + '][configName]" >';
				oTL2 = oTR.insertCell([1]);
				oTL2.innerHTML = '<input type="text" class="txtshort" value="" name="productinfo[configurations][' + mycount + '][configPattern]" />';
				oTL3 = oTR.insertCell([2]);
				oTL3.innerHTML = '<input type="text" class="txtshort" value="" name="productinfo[configurations][' + mycount + '][configNum]" />';
				oTL4 = oTR.insertCell([3]);
				oTL4.innerHTML = '<input type="text" class="txt" value="" name="productinfo[configurations][' + mycount + '][explains]" />';
				oTL5 = oTR.insertCell([4]);
				oTL5.innerHTML = '<img src="images/closeDiv.gif" onclick="mydel(this);" title="删除行">';
				document.getElementById("coutNumb").value = document.getElementById("coutNumb").value * 1 + 1;
			}
			function mydel(obj) {
				var itemtable = document.getElementById("itemtable");
				if (confirm('确定要删除该行？')) {
					var rowNo = obj.parentNode.parentNode.rowIndex;
					itemtable.deleteRow(rowNo);
				}
			}
</script>