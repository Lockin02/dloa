<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>销售合同</title>
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
		<link rel="stylesheet" type="text/css" href="css/yxstyle.css"/>
		<link rel="stylesheet" type="text/css" href="js/jquery/style/yxmenu.css" media="screen" />
		<link rel="stylesheet" type="text/css" href="js/jquery/style/yxmenu.theme.css" media="screen" />
		<link rel="stylesheet" type="text/css" href="js/jquery/style/yxgrid.css" />
		<script type="text/javascript" src="js/jquery/jquery-1.4.2.js"></script>
		<script type="text/javascript" src="js/common/businesspage.js"> </script>

		<script type="text/javascript" src="js/jquery/woo.js"></script>
		<script type="text/javascript" src="js/jquery/component.js"></script>
		<script type="text/javascript" src="js/jquery/dump.js"></script>
		<script type="text/javascript" src="js/jquery/combo/yxcombo.js"></script>
		<script type="text/javascript" src="js/jquery/grid/yxsgrid.js"></script>
		<script type="text/javascript" src="js/jquery/grid/yxgrid.js"></script>
		<script type="text/javascript" src="js/jquery/combo/yxcombogrid.js"></script>
		<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-province.js"></script>
		<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-customer.js"></script>
		<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-linkman.js"></script>
		<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-product.js"></script>
		<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-licenseType.js"></script>
		<script type="text/javascript" src="view/template/contract/sales/js/sales-edit.js"></script>
		<script type="text/javascript" src="view/template/contract/sales/js/sales-js.js"> </script>
		<script type="text/javascript" src="js/validate.js"> </script>
		<script type="text/javascript" src="js/DatePicker/WdatePicker.js" > </script>
		<!-- 附件上传开始 -->
		<script type="text/javascript" src="swfupload/swfupload.js">
		</script>
		<script type="text/javascript" src="swfupload/swfupload.queue.js">
		</script>
		<script type="text/javascript" src="swfupload/fileprogress.js">
		</script>
		<script type="text/javascript" src="swfupload/handlers.js">
		</script>
		<link rel="stylesheet" type="text/css" href="swfupload/upload.css">
		<script Language="JavaScript">
			function saveContract(){
				document.getElementById('form1').action="index1.php?model=contract_change_change&action=editChangeAction&act=save";
			}

			function CheckForm()
            {
                if ($('#ChangeApplyId').val() == "")
                {
                    alert("变更申请单号！");
                    $('#ChangeApplyId').focus();
                    return (false);
                }
                if ($('#contName').val() == "")
                {
                    alert("合同名称需要填写！");
                    $('#contName').focus();
                    return (false);
                }
                if ($('#money').val() == "")
                {
                    alert("合同金额需要填写！");
                    $('#money').focus();
                    return (false);
                }
                if ($('#principalName').val() == "")
                {
                    alert("合同负责人需要填写！");
                    $('#principalName').focus();
                    return (false);
                }
                if ($('#deliveryDate').val() == "") {
					alert("交货日期需要填写！");
					$('#deliveryDate').focus();
					return (false);
				}
				isCorret = checkMoney($("#money").val());
				if(!isCorret){
					alert("输入金额有误");
					$("#money").focus();
					return false;
				}
				return true;
            }

            function openDia(count) {
				var licensetypeid = "licenseinput" + count;
				var licensetype = $("#" + licensetypeid).val();
				if (!licensetype) {
					alert("请先选择license类型！");
				} else {
					var hideid = "licenseNodeId" + count;
					var textid = "licenseNodeName" + count;

					var hidevalue = $("#" + hideid).val();

					//var thisurl = '?model=product_licensecheck_licensecheck&action=setInHtml&contractLicenseId=-1&hidevalue='+hidevalue+'&hideid='+hideid+'&textid='+textid;
					var thisurl = '?model=product_licensetype_licensetype&action=viewPages&ids='
							+ licensetype
							+ '&hidevalue='
							+ hidevalue
							+ '&hideid='
							+ hideid
							+ '&textid=' + textid;
					window.open(thisurl);
				}
			}

			function openDia(count) {
				var licensetypeid = "licenseinput" + count;
				var licensetype = $("#" + licensetypeid).val();
				if (!licensetype) {
					alert("请先选择license类型！");
				} else {
					var hideid = "licenseNodeId" + count;
					var textid = "licenseNodeName" + count;

					var hidevalue = $("#" + hideid).val();

					//var thisurl = '?model=product_licensecheck_licensecheck&action=setInHtml&contractLicenseId=-1&hidevalue='+hidevalue+'&hideid='+hideid+'&textid='+textid;
					var thisurl = '?model=product_licensetype_licensetype&action=viewPages&ids='
							+ licensetype
							+ '&hidevalue='
							+ hidevalue
							+ '&hideid='
							+ hideid
							+ '&textid=' + textid;
					window.open(thisurl);
				}
			}

			var uploadfile;
			$(function() {
				uploadfile=createSWFUpload({
					"serviceType":"oa_contract_sales",
					"serviceId":"{id}",
					"serviceNo":"{contNumber}"
				});
			});
		</script>
	</head>
	<body>
	<form action="?model=contract_change_change&action=editChangeAction"  method="post" onsubmit="return CheckForm()"
		onkeypress="javascript:return NoSubmit(event);" id="form1">
	<table>
		<tr>
			<td><img src="images/sys_config.gif"/>
				<b>合同变更
				</b>
			</td>
		</tr>
	</table>
	<div>
		<table class='form_main_table'>
			<tr class="main_head">
				<td align="center" colspan="4">
					<font >变更申请单</font>
				</td>
			</tr>
			<tr >
	        	<td class="form_text_left">
	        		变更申请单号
	        	</td>
	        	<td class="form_text_right" colspan="3">
	  				<input type="text" name="sales[change][formNumber]" id="ChangeApplyId" value="{formNumber}" class="txt" readonly="readonly"/>
	        	</td>
	        </tr>
	        <tr>
	        	<td class="form_text_left">
	        		变更原因
	        	</td>
	        	<td class="form_text_right" colspan="3">
	        		<textarea name="sales[change][reason]" id="ChangeRemark" class="txt_txtarea_font">{reason}</textarea>
	        	</td>
	    	</tr>

	    	<tr>
	        	<td class="form_text_left">
	        		变更点
	        	</td>
	        	<td class="form_text_right" colspan="3">
	        		<textarea name="sales[change][changepiont]" id="ChangePoint" class="txt_txtarea_font">{changepiont}</textarea>
	        	</td>
	    	</tr>
	    	<tr class="main_head">
				<td align="center" colspan="4">
					<font >变更分析</font>
				</td>
			</tr>
	    	<tr>
	        	<td class="form_text_left">
	        		合同变更影响
	        	</td>
	        	<td class="form_text_right" colspan="3">
	        		<textarea name="sales[change][effect]" id="MissionAffect" class="txt_txtarea_font">{effect}</textarea>
	        	</td>
	    	</tr>
	    	<tr>
	        	<td class="form_text_left" align="center">
	        		变更申请时间
	        	</td>
	        	<td class="form_text_right">
	  				{applyTime}
	        	</td>
	        	<td class="form_text_left">
	        		变更申请人
	        	</td>
	        	<td class="form_text_right">
	  				{applyName}
	  				<input type="hidden" name="sales[change][applyId]" value="{applyId}" readonly />
	        	</td>
	        </tr>
	    </table>
	</div>
	<br/>
	<table class='form_main_table'>
		<tr>
			<td class="form_text_left">
				鼎利合同号
			</td>
			<td class="form_text_right">
				<input type="text" class="readOnlyTxtNormal" name="sales[contNumber]" id="contNumber" value="{contNumber}" readonly="readonly"/>
			</td>
			<td class="form_text_left">
				临时合同号
			</td >
			<td class="form_text_right">
				<input type="text" class="readOnlyTxtNormal" name="sales[temporaryNo]" id="temporaryNo" value="{temporaryNo}" readonly="readonly"/>
			</td>
		</tr>
		<tr>
			<td class="form_text_left">合同名称</td>
			<td class="form_text_right" colspan="3">
				<input class="txt" type="text" name="sales[contName]" id="contName" value="{contName}" size="70"/><span id="_contName" class="red">[*]</span>
			</td>
		</tr>
		<tr>
			<td class="form_text_left">合同金额</td>
			<td class="form_text_right">
				<input class="txt" type="text" name="sales[money]" id="money" value="{money}" size="30" maxlength="100" class="formatMoney"/><span id="_money" class="red">[*]</span>
			</td>
			<td class="form_text_left">
				发票类型
			</td>
			<td class="form_text_right">
				<select class="select" name="sales[invoiceType]" id="invoiceType">
					{invoiceType}
				</select>
			</td>
		</tr>
		<tr>
			<td class="form_text_left">交货日期</td>
			<td class="form_text_right">
				<input type="text" class="txt" name="sales[deliveryDate]" id="deliveryDate" value="{deliveryDate}" size="12" maxlength="12" onfocus="WdatePicker()"/>
				<span id="_deliveryDate" class="red">[*]</span>
			</td>
			<td class="form_text_left">合同负责人</td>
			<td  class="form_text_right">
				<input type="hidden" name="sales[principalId]" id="principalId" value="{principalId}"/>
				<input type="text" class="txt" name="sales[principalName]" id="principalName" readonly  value="{principalName}"/>
				<input type="button" class="txt_btn_a" value="选 择" onclick="loadOrgWindow('principalId','principalName')"/>
				<input type="button" class="txt_btn_a" value="清 空" onclick="clearOrgInfo('principalId','principalName')"/>
				<span class="red">[*]</span>
			</td>
		</tr>
		<tr>
			<td class="form_text_left">客户名称</td>
			<td class="form_text_right">
				<input type="text" class="txt" id="customerName" name="sales[customerName]" value="{customerName}"/>
				<input type="hidden" name="sales[customerId]" id="customerId" value="{customerId}"/>
			</td>
			<td class="form_text_left">
				付款单位
			</td>
			<td class="form_text_right">
				<input type="text" class="txt" id="payUnit" name="sales[payUnit]" value="{payUnit}"/>
			</td>
		</tr>
		<tr>
			<td class="form_text_left">
				客户类型
			</td>
			<td class="form_text_right">
				<select class="txt" name="sales[customerType]" id="customerType">
					{customerType}
				</select>
			</td>
			<td class="form_text_left">
				客户所属省份
			</td>
			<td class="form_text_right">
				<input type="text" class="txt" name="sales[province]" id="province" value="{province}" class="text"/>
			    <input type="hidden" name="sales[provinceId]" id="provinceId"/>
			</td>
		</tr>
		<tr>
			<td class="form_text_left">客户合同号</td>
			<td class="form_text_right" ><input type="text"  class="txt"
				name="sales[customerContNum]" id="customerContNum" size="30"
				maxlength="100" value="{customerContNum}" />
			</td>
<!-- 			<td class="form_text_left">客户联系人</td>
			<td class="form_text_right" ><input type="text"  class="txt"
				name="sales[customerLinkman]" id="customerLinkman" size="35"
				maxlength="100" value="{customerLinkman}" /></td>
		</tr>
		<tr>
			<td class="form_text_left">电话</td>
			<td  class="form_text_right"><input type="text"  class="txt"
				name="sales[customerTel]" id="customerTel" size="30" maxlength="50"
				value="{customerTel}" /></td>
			<td class="form_text_left">邮箱</td>
			<td class="form_text_right"><input type="text"  class="txt"
				name="sales[customerEmail]" id="customerEmail" size="30"
				maxlength="50" value="{customerEmail}"/>
			</td> -->
		</tr>
		<tr>
			<td class="form_text_left">收货地址</td>
			<td class="form_text_right" colspan="3">
				<textarea name="sales[address]" id="address" class="txt_txtarea_font">{address}</textarea></td>
		</tr>
	</table>
	<table class="main_table" width="100%" id="link" cellspacing='1' cellpadding='0'>
		<tr>
			<td colspan="8" class="form_header">
				<font>
					客户联系人
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="linkNum" name="linkNum" value="{linkNum}" />
				<img src="images/verpic_open.gif" onclick="dis('mylink')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="link_add('mylink','linkNum')" title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="mylink" width="100%" class="main_table" cellspacing='1' cellpadding='0'>
		<tr class="main_tr_header">
			<td nowrap style="text-align:center">
				序号
			</td>
			<td style="text-align:center">
				客户联系人
			</td>
			<td style="text-align:center">
				电话
			</td>
			<td style="text-align:center">
				邮件
			</td>
			<td style="text-align:center">
				备注
			</td>
			<td style="text-align:center">
				操作
			</td>
		</tr>
		{linkman}
	</table>
	<table class="form_main_table" id="equ" width="100%">
		<tr>
			<td class="form_header" colspan="4">
				<font>
					产品清单
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="EquNum" name="EquNum" value="{equNum}" />
				<img src="images/verpic_open.gif" onclick="dis('myequ')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="soft_add('myequ','EquNum')" title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="myequ" class="form_main_table">
		<tr class="main_tr_header">
			<td style="text-align:center" width="5%">
				序号
			</td>
			<td width="9%" style="text-align:center">
				产品线
			</td>
			<td style="text-align:center" width="10%">
				产品编号
			</td>
			<td width="16%" style="text-align:center">
				产品名称
			</td>
			<td width="9%" style="text-align:center">
				型号/版本
			</td>
			<td width="8%" style="text-align:center">
				数量
			</td>
			<td width="8%" style="text-align:center">
				单价
			</td>
			<td width="8%" style="text-align:center">
				金额
			</td>
			<td width="10%" style="text-align:center">
				计划交货日期
			</td>
			<td width="8%" style="text-align:center">
				保修期
			</td>
			<td style="text-align:center">
				合同内
			</td>
			<td width="5%" style="text-align:center">
				操作
			</td>
		</tr>
		{equipment}
	</table>
	<table class="form_main_table">
		<tr >
			<td class="form_header" colspan="4">
				<font>
					加密信息
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="licenseNum" name="licenseNum" value="{licenseNum}"/>
				<img src="images/verpic_open.gif" onclick="dis('mylicense')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="license_add('mylicense','licenseNum')" title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="mylicense" class="form_main_table">
		<tr class="main_tr_header">
			<td width="5%" style="text-align:center">
				序号
			</td>
			<td width="10%" style="text-align:center">
				产品线
			</td>
			<td width="10%" style="text-align:center">
				软件狗类型
			</td>
			<td width="10%" style="text-align:center">
				数量
			</td>
			<td width="12%" style="text-align:center">
				License
			</td>
			<td width="16%" style="text-align:center">
				License树
			</td>
			<td width="8%" style="text-align:center">
				有效期
			</td>
			<td style="text-align:center">
				备注
			</td>
			<td width="4%" style="text-align:center">
				合同内
			</td>
			<td width="5%" style="text-align:center">
				删除
			</td>
		</tr>
		{licenselist}
	</table>
	<table id="pre" class="form_main_table">
		<tr >
			<td class="form_header" colspan="7">
				<font>
					自定义清单
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="PreNum" name="PreNum" value="{cusNum}" />
				<img src="images/verpic_open.gif" onclick="dis('mycustom')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="pre_add('mycustom','PreNum')" title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="mycustom" class="form_main_table">
		<tr class="main_tr_header">
			<td width="5%" style="text-align:center">
				序号
			</td>
			<td width="10%" style="text-align:center">
				产品线
			</td>
			<td style="text-align:center">
				产品编号
			</td>
			<td style="text-align:center">
				产品名称
			</td>
			<td style="text-align:center">
				产品型号
			</td>
			<td width="8%" style="text-align:center">
				数量
			</td>
			<td width="8%" style="text-align:center">
				单价
			</td>
			<td width="8%" style="text-align:center">
				金额
			</td>
			<td width="8%" style="text-align:center">
				计划交货日期
			</td>
			<td width="15%" style="text-align:center">
				备注
			</td>
			<td width="4%" style="text-align:center">
				合同内
			</td>
			<td width="5%" style="text-align:center">
				操作
			</td>
		</tr>
		{customizelist}
	</table>
	<table id="inv" class="form_main_table">
		<tr >
			<td class="form_header" colspan="4">
				<font>
					开票计划
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="InvNum" name="InvNum" value="{invNum}" />
				<img src="images/verpic_open.gif" onclick="dis('myinv')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="inv_add('myinv','InvNum')" title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="myinv" class="form_main_table">
		<tr class="main_tr_header">
			<td width="5%" style="text-align:center">
				序号
			</td>
			<td width="10%" style="text-align:center">
				开票金额
			</td>
			<td width="10%" style="text-align:center">
				其中软件金额
			</td>
			<td width="10%" style="text-align:center">
				开票类型
			</td>
			<td style="text-align:center">
				开票日期
			</td>
			<td style="text-align:center">
				开票内容
			</td>
			<td width="5%" style="text-align:center">
				操作
			</td>
		</tr>
		{invlist}
	</table>
	<table id="pay" class="form_main_table">
		<tr >
			<td class="form_header" colspan="3">
				<font>
					收款计划
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="PayNum" name="PayNum" value="{payNum}" />
				<img src="images/verpic_open.gif" onclick="dis('mypay')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="pay_add('mypay','PayNum')" title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="mypay" class="form_main_table">
		<tr class="main_tr_header">
			<td width="5%" style="text-align:center">
				序号
			</td>
			<td width="10%" style="text-align:center">
				收款金额
			</td>
			<td style="text-align:center">
				收款日期
			</td>
			<td style="text-align:center">
				收款方式
			</td>
			<td style="text-align:center">
				收款条件
			</td>
			<td width="5%" style="text-align:center">
				操作
			</td>
		</tr>
		{receiptplan}
	</table>
	<table id="tra" class="form_main_table">
		<tr >
			<td class="form_header" colspan="7">
	<font>
					培训计划
				</font>
			</td>
			<td align="center" width="5%">
				<input type="hidden" id="TraNumber" name="TraNumber" value="{traNumber}"
				/>
				<img src="images/verpic_open.gif" onclick="dis('mytra')" title="缩放"/>
				<img src="images/collapsed.gif" onclick="train_add('mytra','TraNumber')"
				title="添加行"/>
			</td>
		</tr>
	</table>
	<table id="mytra" class="form_main_table">
		<tr class="main_tr_header">
			<td width="5%" style="text-align:center">
				序号
			</td>
			<td width="8%" style="text-align:center">
				培训开始时间
			</td>
			<td width="8%" style="text-align:center">
				培训结束时间
			</td>
			<td width="8%" style="text-align:center">
				参与人数
			</td>
			<td width="18%" style="text-align:center">
				培训地点
			</td>
			<td style="text-align:center">
				培训内容
			</td>
			<td width="20%" style="text-align:center">
				培训工程师要求
			</td>
			<td width="5%" style="text-align:center">
				操作
			</td>
		</tr>
		{trainingplan}
	</table>
	<table class='form_main_table'>
		<tr>
			<td class="form_header" colspan="4">
				<font>
					保修条款
				</font>
				<img src="images/verpic_open.gif" onclick="dis('gua')" title="缩放"/>
			</td>
		</tr>
		<tr id="gua">
			<td colspan="4">
				<textarea name="sales[warrantyClause]" id="warrantyClause" rows="5" style="width: 100%">{warrantyClause}</textarea>
			</td>
		</tr>
		<tr>
			<td class="form_header" colspan="4">
				<font>
					售后要求
				</font>
				<img src="images/verpic_open.gif" onclick="dis('aft')" title="缩放"/>
			</td>
		</tr>
		<tr id="aft">
			<td colspan="4">
				<textarea style="width: 100%" name="sales[afterService]" id="afterService" rows="5">{afterService}</textarea>
			</td>
		</tr>

		<tr>
			<td colspan="4">
				合同附件 &nbsp;
				<div class="upload">
					<div class="upload" id="fsUploadProgress">
					</div>
					<div class="upload">
						<span id="swfupload">
						</span>
						<input id="btnCancel" type="button" value="中止上传" onclick="cancelQueue(uploadfile);"
						disabled="disabled" />
						<br />
					</div>
					<div id="uploadfileList" class="upload">
						{file}
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td align="center" class="main_foot_wraper" colspan="4" align="left">
				签约状态： &nbsp;{signStatus}
			</td>
		</tr>
		<tr>
			<td class="main_foot_wraper" colspan="4">
				发货条件 : &nbsp;{shipCondition}

			</td>
		</tr>
		<tr>
			<td class="main_foot_wraper" colspan="4">
				提交方式 : &nbsp;{startType}

			</td>
		</tr>
		 <tr>
		 	<td class="footform" colspan="4">
		 		<input type="hidden" name="sales[change][id]" id="contractId" value="{formId}"/>
		 		<input type="hidden" name="sales[id]" id="contractId" value="{newContId}"/>
		 		<input type="hidden" name="sales[version]" id="version" value="{version}"/>
			 	<input class="txt_btn_a" type="submit" value="提交审批" />&nbsp;&nbsp;
			 	<input class="txt_btn_a" type="submit" value=" 保 存 " name="save" onclick="saveContract();"/>&nbsp;&nbsp;
			 	<input class="txt_btn_a" type="button" value=" 返 回 " name="save" onclick="history.back();"/>
		 	</td>
		 </tr>
		 </table>
	 </form>
	</body>
</html>
