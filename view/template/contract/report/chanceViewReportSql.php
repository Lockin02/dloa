<?php
include '../../../../webreport/data/mysql_GenXmlData.php';
?>
<?php
$year = $_GET['year'];
$areaName = $_GET['areaName'];
if($areaName == ';;'){
	$areaNameSql = " ";
}else if($areaName == ''){
	$areaNameSql = " and province = 'none'";
}else{
    $areaNameSql = " and province in ($areaName)";
}
$whereSql =  " where 1=1 and year = '$year' $areaNameSql";
$sql = "and year = '$year' $areaNameSql";

$QuerySQL = <<<QuerySQL
/*全国*/
select year,areaPrincipal,province,customerTypeName,0 as ordnum,type,if(type='金额',"全国","") as typeName,1 as gradeNum,0 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view $whereSql
 GROUP BY type
union all

/*移动 + 第三方*/
select year,areaPrincipal,province,customerTypeName,0 as ordnum,type,if(type='金额',"移动+第三方","") as typeName,1 as gradeNum,1 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view where (customerTypeName = '移动' or customerTypeName = '运营商-移动集团' or customerTypeName = '第三方' or customerTypeName = '移动+第三方') $sql GROUP BY type

union all

/*联通*/
select year,areaPrincipal,province,customerTypeName,0 as ordnum,type,if(type='金额',"联通","") as typeName,1 as gradeNum,2 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view where ( customerTypeName = '联通' or customerTypeName = '运营商-联通集团') $sql GROUP BY type

 union all
/*电信*/
select year,areaPrincipal,province,customerTypeName,0 as ordnum,type,if(type='金额',"电信","") as typeName,1 as gradeNum,3 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view where (customerTypeName = '电信' or customerTypeName = '运营商-电信集团') $sql GROUP BY type

 union all
  /*系统商*/
select year,areaPrincipal,province,customerTypeName,0 as ordnum,type,if(type='金额',"系统商","") as typeName,1 as gradeNum,5 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view where customerTypeName = '系统商' $sql GROUP BY type

 union all
/*明细数据*/
select * from (
select year,areaPrincipal,if(p.replacename is not null or p.replacename != '',p.replacename,province) as province,'' as customerTypeName,1 as ordnum,type,if(type='金额',if(p.replacename is not null or p.replacename != '',p.replacename,province),"") as typeName,2 as gradeNum,6 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view
   left join oa_sale_chance_viewarea_person p on province=p.proname
   $whereSql GROUP BY type,province
union all
select year,areaPrincipal,if(p.replacename is not null or p.replacename != '',p.replacename,province) as province,customerTypeName,0 as ordnum,type,if(type='金额',customerTypeName,"") as typeName,3 as gradeNum,6 as num,
   sum(Q1_100_01) as Q1_100_01,sum(Q1_100_02) as Q1_100_02,sum(Q1_100_03) as Q1_100_03,sum(Q1_100_all) as Q1_100_all,sum(Q1_80_01) as Q1_80_01,sum(Q1_80_02) as Q1_80_02,sum(Q1_80_03) as Q1_80_03,sum(Q1_80_all) as Q1_80_all,sum(Q1_50_01) as Q1_50_01,sum(Q1_50_02) as Q1_50_02,sum(Q1_50_03) as Q1_50_03,sum(Q1_50_all) as Q1_50_all,sum(Q1_25_01) as Q1_25_01,sum(Q1_25_02) as Q1_25_02,sum(Q1_25_03) as Q1_25_03,sum(Q1_25_all) as Q1_25_all,sum(Q1_0_00) as Q1_0_00,sum(Q1_0_01) as Q1_0_01,
   sum(Q2_100_01) as Q2_100_01,sum(Q2_100_02) as Q2_100_02,sum(Q2_100_03) as Q2_100_03,sum(Q2_100_all) as Q2_100_all,sum(Q2_80_01) as Q2_80_01,sum(Q2_80_02) as Q2_80_02,sum(Q2_80_03) as Q2_80_03,sum(Q2_80_all) as Q2_80_all,sum(Q2_50_01) as Q2_50_01,sum(Q2_50_02) as Q2_50_02,sum(Q2_50_03) as Q2_50_03,sum(Q2_50_all) as Q2_50_all,sum(Q2_25_01) as Q2_25_01,sum(Q2_25_02) as Q2_25_02,sum(Q2_25_03) as Q2_25_03,sum(Q2_25_all) as Q2_25_all,sum(Q2_0_00) as Q2_0_00,sum(Q2_0_01) as Q2_0_01,
   sum(Q3_100_01) as Q3_100_01,sum(Q3_100_02) as Q3_100_02,sum(Q3_100_03) as Q3_100_03,sum(Q3_100_all) as Q3_100_all,sum(Q3_80_01) as Q3_80_01,sum(Q3_80_02) as Q3_80_02,sum(Q3_80_03) as Q3_80_03,sum(Q3_80_all) as Q3_80_all, sum(Q3_50_01) as Q3_50_01,sum(Q3_50_02) as Q3_50_02,sum(Q3_50_03) as Q3_50_03,sum(Q3_50_all) as Q3_50_all,sum(Q3_25_01) as Q3_25_01,sum(Q3_25_02) as Q3_25_02,sum(Q3_25_03) as Q3_25_03,sum(Q3_25_all) as Q3_25_all,sum(Q3_0_00) as Q3_0_00,sum(Q3_0_01) as Q3_0_01,
   sum(Q4_100_01) as Q4_100_01,sum(Q4_100_02) as Q4_100_02,sum(Q4_100_03) as Q4_100_03,sum(Q4_100_all) as Q4_100_all,sum(Q4_80_01) as Q4_80_01,sum(Q4_80_02) as Q4_80_02,sum(Q4_80_03) as Q4_80_03,sum(Q4_80_all) as Q4_80_all,sum(Q4_50_01) as Q4_50_01,sum(Q4_50_02) as Q4_50_02,sum(Q4_50_03) as Q4_50_03,sum(Q4_50_all) as Q4_50_all,sum(Q4_25_01) as Q4_25_01,sum(Q4_25_02) as Q4_25_02,sum(Q4_25_03) as Q4_25_03,sum(Q4_25_all) as Q4_25_all,sum(Q4_0_00) as Q4_0_00,sum(Q4_0_01) as Q4_0_01,
   sum(all_100_01) as all_100_01,sum(all_100_02) as all_100_02,sum(all_100_03) as all_100_03,sum(all_100_all) as all_100_all,sum(all_80_01) as all_80_01,sum(all_80_02) as all_80_02,sum(all_80_03) as all_80_03,sum(all_80_all) as all_80_all,sum(all_50_01) as all_50_01,sum(all_50_02) as all_50_02,sum(all_50_03) as all_50_03,sum(all_50_all) as all_50_all,sum(all_25_01) as all_25_01,sum(all_25_02) as all_25_02,sum(all_25_03) as all_25_03,sum(all_25_all) as all_25_all,sum(all_0_00) as all_0_00,sum(all_0_01) as all_0_01
 from oa_chance_view
   left join oa_sale_chance_viewarea_person p on province=p.proname
   $whereSql GROUP BY type,province,customerTypeName
) c ORDER BY num,CONVERT(province USING gbk),customerTypeName,type desc


QuerySQL;
GenAttrXmlData($QuerySQL, false);
?>
