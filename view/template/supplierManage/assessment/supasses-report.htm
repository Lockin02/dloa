<HTML>
<HEAD>
<TITLE>供应商年度考核汇总</TITLE>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
    <OBJECT id="Report" classid="CLSID:50CA95AF-BDAA-4C69-A9C6-93E1136E68BC" codebase="webreport/griectl.cab#Version=5,0,9,808" VIEWASTEXT></OBJECT>
    <link rel="stylesheet" type="text/css" href="css/yxstyle.css" />
    <link rel="stylesheet" type="text/css" href="js/thickbox.css" media="screen" />
    <script src="webreport/CreateControl.js" language="javascript"></script>

    <script type="text/javascript" src="js/jquery/jquery-1.4.2.js"></script>
    <script type="text/javascript" src="js/common/businesspage.js"></script>
<script type="text/javascript" src="view/template/supplierManage/assessment/js/supasses-search.js"></script>
<script>
    var Report;
    var ReportViewer;
    function OnReportViewerContentCellDblClick(pSender){
        //演示超链接功能，在这里做打开链接任务，这里用弹出消息框代替
        if(!ReportViewer){
            ReportViewer = document.getElementById("ReportViewer");
            Report = ReportViewer.Report;
        }
    if (pSender.Column.Name == "单据编号")
    {
        //获取单据Id
        var formId = Report.FieldByName("单据ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_assessment_supasses&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_assessment_supasses&action=toView&id=" + formId +"&skey=" + skey ,1);
    }
        if (pSender.Column.Name == "供应商名称")
    {
        //获取单据Id
        var formId = Report.FieldByName("供应商ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_formal_flibrary&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_formal_flibrary&action=toRead&id=" + formId +"&skey=" + skey ,1);
    }
    //第一季度

        if (pSender.Column.Name == "第一季度"&&Report.FieldByName("第一季度ID").AsString!="")
    {
        //获取单据Id
        var formId = Report.FieldByName("第一季度ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_assessment_supasses&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_assessment_supasses&action=toView&id=" + formId +"&skey=" + skey ,1);
    }
    //第二季度

        if (pSender.Column.Name == "第二季度"&&Report.FieldByName("第二季度ID").AsString!="")
    {
        //获取单据Id
        var formId = Report.FieldByName("第二季度ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_assessment_supasses&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_assessment_supasses&action=toView&id=" + formId +"&skey=" + skey ,1);
    }
    //第三季度

        if (pSender.Column.Name == "第三季度"&&Report.FieldByName("第三季度ID").AsString!="")
    {
        //获取单据Id
        var formId = Report.FieldByName("第三季度ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_assessment_supasses&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_assessment_supasses&action=toView&id=" + formId +"&skey=" + skey ,1);
    }
    //第四季度

        if (pSender.Column.Name == "第四季度"&&Report.FieldByName("第四季度ID").AsString!="")
    {
        //获取单据Id
        var formId = Report.FieldByName("第四季度ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_assessment_supasses&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_assessment_supasses&action=toView&id=" + formId +"&skey=" + skey ,1);
    }
    //年度考核

        if (pSender.Column.Name == "年度考核"&&Report.FieldByName("年度考核ID").AsString!="")
    {
        //获取单据Id
        var formId = Report.FieldByName("年度考核ID").AsString;
        var skey = "";
        $.ajax({
		    type: "POST",
		    url: "?model=supplierManage_assessment_supasses&action=md5RowAjax",
		    data: { "id" : formId },
		    async: false,
		    success: function(data){
		   	   skey = data;
			}
		});
		showModalWin("?model=supplierManage_assessment_supasses&action=toView&id=" + formId +"&skey=" + skey ,1);
    }
    }

</script>
</HEAD>
<BODY style="margin:0" bgcolor="buttonface">
<table border="0" width="100%" height="100%">
	<tr>
		<td>
			<input type="button" class="txt_btn_a" id="searchBtn" onclick="searchBtn();" value=" 查  询 "/>
			<!-- <input type="button" class="txt_btn_a" id="searchBtn" onclick="toExcelIn();" value="导入2012第一季度信息"/> -->
		</td>
	</tr>
	<tr height="100%">
		<td colspan="5" style="font-size: 10pt;" height="100%">
			<input type="hidden" id="beginYear" value="{beginYear}"/>
			<input type="hidden" id="endYear" value="{endYear}"/>
			<input type="hidden" id="suppName" value="{suppName}"/>
			<script language="javascript">
			    //用查询显示控件展现报表，从URL“../grf/1a.grf”获取报表膜板定义，从URL“../data/xmlCustomer.php”获取XML形式的报表数据，
                CreateDisplayViewerEvent("view/template/supplierManage/assessment/supasses-report.grf"
				,"view/template/supplierManage/assessment/supasses-report.php"
				+ "?beginYear="+$("#beginYear").val()
				+ "&endYear=" + $("#endYear").val()
				+ "&suppName="+$("#suppName").val(),
                        "<param name=RowSelection value=false>"
                                + "<param name='OnContentCellDblClick' value='OnReportViewerContentCellDblClick'>"
				)
			</script>
		</td>
	</tr>
</table>
</BODY>
</HTML>