<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US" xml:lang="en_US">
<head>
	<title>开票申请单</title>
	<meta http-equiv="Content-Type" content="text/html; charset=GB2312" />
	<link rel="stylesheet" type="text/css" href="css/yxstyle.css"/>
	<link rel="stylesheet" type="text/css" href="js/jquery/style/yxgrid.css" />
	<link rel="stylesheet" type="text/css" href="js/jquery/style/yxmenu.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="js/jquery/style/yxmenu.theme.css" media="screen" />

	<script type="text/javascript" src="js/jquery/jquery-1.4.2.js"></script>
	<script type="text/javascript" src="js/common/businesspage.js"></script>
	<script type="text/javascript" src="js/DatePicker/WdatePicker.js"></script>

	<script type="text/javascript" src="js/jquery/woo.js"></script>
	<script type="text/javascript" src="js/jquery/component.js"></script>

	<script type="text/javascript" src="js/jquery/combo/yxcombo.js"></script>
	<script type="text/javascript" src="js/jquery/grid/yxsgrid.js"></script>
	<script type="text/javascript" src="js/jquery/grid/yxgrid.js"></script>
	<script type="text/javascript" src="js/jquery/combo/yxcombogrid.js"></script>
	<script type="text/javascript" src="js/jquery/combo/business/yxselect-user.js"></script>
	<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-datadict.js"></script>
	<script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-logistics.js"></script>
    <script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-stampconfig.js"></script>
    <script type="text/javascript" src="js/jquery/combo/business/yxcombogrid-currency.js"></script>

	<script type="text/javascript" src="view/template/finance/invoiceapply/js/invoiceapply-edit.js"></script>
	<script type="text/javascript" src="view/template/finance/invoiceapply/js/invoiceapply-combo.js"></script>
	<!-- 附件上传开始 -->
	<script type="text/javascript" src="swfupload/swfupload.js"> </script>
	<script type="text/javascript" src="swfupload/swfupload.queue.js"> </script>
	<script type="text/javascript" src="swfupload/fileprogress.js"> </script>
	<script type="text/javascript" src="swfupload/handlers.js"> </script>
	<link rel="stylesheet" type="text/css" href="swfupload/upload.css" />
	<script>
        var uploadfile;
        $(function() {
            uploadfile = createSWFUpload({
                 "serviceType": "oa_finance_invoiceapply",
                 "serviceId": "{id}"
             });
        });
	</script>
	<!-- 附件上传结束 -->
</head>
<body>
<form id="form1" action="?model=finance_invoiceapply_invoiceapply&action=edit" method="post" onsubmit="return checkform();" onkeypress="javascript:return NoSubmit(event);">
<table class="form_main_table" style="width:1200px;margin:auto;align:center">
	<tr class="main_head">
		<th colspan="4">开票申请单</th>
	</tr>
	<tr>
		<td class="form_text_left">发票类型</td>
		<td class="form_text_right">
			<select id="invoiceType" name="invoiceapply[invoiceType]" class="select" onchange="changeInvType(this.id);">
				{invoiceType}
			</select>
		</td>
		<td class="form_text_left_three">归属公司</td>
		<td class="form_text_right_three">
			<input type="text" class="readOnlyTxtNormal" readonly="readonly" name="invoiceapply[businessBelongName]" id="businessBelongName" value="{businessBelongName}"/>
			<input type="hidden" name="invoiceapply[businessBelong]" id="businessBelong" value="{businessBelong}"/>
		 	<input type="hidden" name="invoiceapply[formBelong]" id="formBelong" value="{formBelong}" />
		 	<input type="hidden" name="invoiceapply[formBelongName]" id="formBelongName" value="{formBelongName}"/>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">客户名称</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[customerName]" id="customerName" value="{customerName}" class="readOnlyTxtNormal" readonly="readonly"/>
			<input type="hidden" name="invoiceapply[customerId]" id="customerId" value="{customerId}"/>
		</td>

		<td class="form_text_left">客户类型</td>
		<td class="form_text_right">
			<input type="text" value="{customerTypeName}" class="readOnlyTxtNormal" readonly="readonly"/>
			<input type="hidden" name="invoiceapply[customerType]" value="{customerType}"/>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">源单类型</td>
		<td class="form_text_right" width="30%">
			<input type="text" value="{objTypeName}" class="readOnlyTxtNormal" readonly="readonly"/>
			<input type="hidden" name="invoiceapply[objType]" id="objType" value="{objType}"/>
			<input type="hidden" name="invoiceapply[objId]" id="objId" value="{objId}"/>
		</td>
		<td class="form_text_left">源单编号</td>
		<td class="form_text_right">
			<input type="hidden" name="invoiceapply[applyNo]" id="applyNo" value="{applyNo}"/>
			<input type="text" id="objCode" value="{objCode}" class="readOnlyTxtNormal" readonly="readonly"/>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">联 系 人</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[linkMan]" id="linkMan" value="{linkMan}" class="txt"/>
			<span class="red">[*]</span>
		</td>
		<td class="form_text_left">电 话</td>
		<td class="form_text_right"	>
			<input type="text" name="invoiceapply[linkPhone]" id="linkPhone" value="{linkPhone}" class="txt"/>
			<span class="red">[*]</span>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">开票单位地址</td>
		<td class="form_text_right" colspan="3">
			<input type="text" name="invoiceapply[unitAddress]" id="unitAddress" value="{unitAddress}" class="txtbiglong" class="txtbiglong" style="width:845px;"/>
			<span class="red" id="unitAddressNeed">[*]</span>
		</td>
	</tr>
	<tr>
		<td class="form_text_left" title="发票邮寄地址，不填则默认邮寄地址为开票单位地址">
			发票邮寄地址
			<span class="red">!</span>
		</td>
		<td class="form_text_right" colspan="3">
			<input type="text" name="invoiceapply[linkAddress]" id="linkAddress" value="{linkAddress}" class="txtbiglong" class="txtbiglong" style="width:845px;"/>
			<span class="red" id="linkAddressNeed"></span>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">备 注</td>
		<td class="form_text_right" colspan="3">
			<input type="text" name="invoiceapply[remark]" value="{remark}" class="txtbiglong" class="txtbiglong" style="width:845px;"/>
		</td>
	</tr>
	<tr class="phoneNo">
		<td class="form_text_left" title="不可填写手机号码">
			开票单位电话
			<span class="red">!</span>
		</td>
		<td class="form_text_right" colspan="3">
			<input type="text" name="invoiceapply[phoneNo]" id="phoneNo" class="txt" value="{phoneNo}"/>
			<span id="phoneNoNeed" class="red"></span>
		</td>
	</tr>
	<tr class="taxpayerNo">
		<td class="form_text_left">纳税人识别号</td>
		<td class="form_text_right" colspan="3">
			<input type="text" name="invoiceapply[taxpayerId]" id="taxpayerId" class="txt" value="{taxpayerId}" />
			<span id="taxpayerIdNeed" class="red"></span>
		</td>
	</tr>
	<tr class="bankInfo">
		<td class="form_text_left">开户银行</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[bank]" id="bank" class="txt" value="{bank}"/>
			<span id="bankNeed" class="red"></span>
		</td>
		<td class="form_text_left">银行账号</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[bankCount]" id="bankCount" class="txt" value="{bankCount}"/>
			<span id="bankCountNeed" class="red"></span>
		</td>
	</tr>
	<tr class="rentInfo">
		<td class="form_text_left">租赁开始日期</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[rentBeginDate]" id="rentBeginDate" class="txt" onfocus="WdatePicker()" onchange="rentDaysCount()" value="{rentBeginDate}"/>
			<span id="rentBeginDateNeed" class="red"></span>
		</td>
		<td class="form_text_left">租赁结束日期</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[rentEndDate]" id="rentEndDate" class="txt" onfocus="WdatePicker()" onchange="rentDaysCount()" value="{rentEndDate}"/>
			<span id="rentEndDateNeed" class="red"></span>
		</td>
	</tr>
	<tr class="rentInfo">
		<td class="form_text_left">租赁天数</td>
		<td class="form_text_right" colspan="3">
			<input type="text" name="invoiceapply[rentDays]" id="rentDays" class="readOnlyTxtNormal" readonly="readonly" value="{rentDays}"/>
			<span id="rentDaysNeed" class="red"></span>
		</td>
	</tr>
	<tr>
   		<td class="form_text_left">是否需要邮寄
       	</td>
   		<td class="form_text_right" colspan="3">
   			<input type="radio" name="invoiceapply[isMail]" id="isMailYes" value="1" onclick="changeIsMail(this.value)"/>是
      		<input type="radio" name="invoiceapply[isMail]" id="isMailNo" value="0" onclick="changeIsMail(this.value)"/>否
      		<input type="hidden" id="isMail" value="{isMail}" />
		</td>
   		<!--td class="form_text_left"><span class="red">是否异地开票</span></td>
   		<td class="form_text_right">
   			<input type="radio" name="invoiceapply[isOffSite]" id="isOffSiteYes" value="1" onchange="changeMailInfo(this.value)"/>是
      		<input type="radio" name="invoiceapply[isOffSite]" id="isOffSiteNo" value="0" onchange="changeMailInfo(this.value)" checked="checked"/>否
      		<input type="hidden" id="isOffSite" value="{isOffSite}" />
		</td-->
	</tr>
	<tr id="mailInfo">
		<td class="form_text_left">快递公司</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[expressCompany]" id="expressCompany" value="{expressCompany}" class="txt" readonly="readonly"/>
			<input type="hidden" name="invoiceapply[expressCompanyId]" id="expressCompanyId" value="{expressCompanyId}"/>
			<span class="red">[*]</span>
		</td>
		<td class="form_text_left">邮政编码</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[postalCode]" id="postalCode" class="txt" value="{postalCode}"/>
			<span class="red">[*]</span>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">是否盖章</td>
		<td class="form_text_right">
			<input type="radio" name="invoiceapply[isNeedStamp]" id="isNeedStampYes" value="1" onclick="changeIsStamp(this.value)"/>是
	      	<input type="radio" name="invoiceapply[isNeedStamp]" id="isNeedStampNo" value="0" onclick="changeIsStamp(this.value)"/>否
	      	<input type="hidden" id="isNeedStamp" value="{isNeedStamp}" />
		</td>
		<td class="form_text_left" >盖章类型</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[stampType]" id="stampType" class="txt" value="{stampType}" />
            <span class="red" style="display:none" id="radioSpan">[*]</span>
		</td>
	</tr>
	<tr>
		<td class="form_text_left_three">附&nbsp;&nbsp;&nbsp;&nbsp;件</td>
		<td class="form_text_right_three" colspan="3">
			<div class="upload">
			<div class="upload" id="fsUploadProgress"></div>
			<div class="upload">
			<span id="swfupload"></span>
			<input id="btnCancel" type="button" value="中止上传" onclick="cancelQueue(uploadfile);" disabled="disabled" /> <br />
			</div>
				<div id="uploadfileList" class="upload">{file}</div>
			</div>
		</td>
   </tr>
	<tr>
		<td class="innerTd" colspan="4" style="max-width: 800px;overflow-x: scroll">
		<!--<td class="innerTd" colspan="4">-->
			<table class="form_in_table">
				<thead>
					<tr>
						<td width="5%" class="form_header" style="text-align: center">
							<input type="hidden" id="invnumber" name="invnumber" value="{invnumber}"/>
							<img src="images/collapsed.gif" onclick="detailAdd('invbody','invnumber');" title="添加行"/>
						</td>
                        <td align="left" class="form_header" colspan="16">
                            开票内容
                        </td>
					</tr>
				</thead>
				<tbody id="invbody">
					<tr class="main_tr_header">
						<th width="5%">序号</th>
						<th>货品名称/服务项目</th>
						<th>数量</th>
						<th>软件金额</th>
						<th>硬件金额</th>
						<th>维修金额</th>
						<th>服务金额</th>
						<th>设备租赁金额</th>
						<th>场地租赁金额</th>
						<th>其他金额</th>
						<th>代收电费金额</th>
						<th>代收水费金额</th>
						<th>房屋出租金额</th>
						<th>安装服务金额</th>
						<th>产品/服务类型</th>
						<th>备注</th>
						<th width="5%">操作</th>
					</tr>
					{detail}
				</tbody>
				<tr class="tr_count">
					<td colspan="2">合计</td>
					<td></td>
					<td><input type="text" id="view_softMoney" name="invoiceapply[softMoney]" value="{softMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_hardMoney" name="invoiceapply[hardMoney]" value="{hardMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_repairMoney" name="invoiceapply[repairMoney]" value="{repairMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_serviceMoney" name="invoiceapply[serviceMoney]" value="{serviceMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_equRentalMoney" name="invoiceapply[equRentalMoney]" value="{equRentalMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_spaceRentalMoney" name="invoiceapply[spaceRentalMoney]" value="{spaceRentalMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_otherMoney" name="invoiceapply[otherMoney]" value="{otherMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_dsEnergyCharge" name="invoiceapply[dsEnergyCharge]" value="{dsEnergyCharge}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_dsWaterRateMoney" name="invoiceapply[dsWaterRateMoney]" value="{dsWaterRateMoney}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_houseRentalFee" name="invoiceapply[houseRentalFee]" value="{houseRentalFee}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td><input type="text" id="view_installationCost" name="invoiceapply[installationCost]" value="{installationCost}" class="readOnlyTxtShortCount formatMoney" readonly="readonly"/></td>
					<td colspan="3"></td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="innerTd" colspan="4">
		<table class="form_in_table">
			<tr>
                <td align="left" class="form_header" colspan="3">
                    扣款信息
                </td>
                <td width="5%" class="form_header" style="text-align: center">
                    <input type="hidden" id="invnumber2" name="invnumber2" value="{invnumber2}"/>
                    <img src="images/collapsed.gif" onclick="deductinfoAdd('invbody2','invnumber2');" title="添加行"/>
                </td>
			</tr>
			<tbody id="invbody2">
				<tr class="main_tr_header">
					<th width="5%">序号</th>
					<th>考核分数</th>
					<th>本期扣款</th>
					<th width="5%">操作</th>
				</tr>
				{deductinfo}
			</tbody>
		</table>
		</td>
	</tr>
	<tr>
        <td class="form_text_left">币 别</td>
        <td class="form_text_right">
            <input type="text" name="invoiceapply[currency]" id="currency" value="{currency}" class="readOnlyTxtNormal" readonly="readonly"/>
        </td>
		<td class="form_text_left">申请总金额</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[invoiceMoney]" id="invoiceMoney" value="{invoiceMoney}" class="formatMoney readOnlyTxtNormal" readonly="readonly"/>
            <input type="hidden" name="invoiceapply[allAmount]" id="allAmount" value="{allAmount}"/>
            <input type="hidden" name="invoiceapply[contLocal]" id="contLocal" value="{contLocal}"/>
            <input type="hidden" name="invoiceapply[invoiceLocal]" id="invoiceLocal" value="{invoiceLocal}"/>
		</td>
	</tr>
	<tr>
		<td class="form_text_left">{objTypeName}金额</td>
		<td class="form_text_right">
			<input type="text" name="invoiceapply[contAmount]" id="contAmount" value="{contAmount}" class="readOnlyTxtNormal formatMoney" readonly="readonly"/>
		</td>
		<td class="form_text_left"><span class="red">剩余可申请金额</span></td>
		<td class="form_text_right">
			<input type="text" id="canApply" value="{canApply}" class="readOnlyTxtNormal formatMoney" readonly="readonly"/>
		</td>
	</tr>
	<tr>
   		<td class="form_text_left">是否发送邮件
       	</td>
   		<td colspan="3" class="form_text_right">
   			<input type="radio" name="invoiceapply[issend]" value="y" checked="checked" onclick="checkEmailTA(this)"/>是
      		<input type="radio" name="invoiceapply[issend]" value="n" onclick="checkEmailTA(this)"/>否
		</td>
	</tr>
   	<tr id="maildiv">
   		<td class="form_text_left">邮件接收人
       	</td>
       	<td colspan="3" class="form_text_right">
		    <input type="text" name="invoiceapply[TO_NAME]" id="TO_NAME" class="txtlong" readonly="readonly"/>
    		<input type="hidden" name="invoiceapply[TO_ID]" id="TO_ID"/>
	    </td>
   	</tr>
	<tr>
		<td colspan="4">
			<input type="hidden" name="invoiceapply[id]" id="applyId" value="{id}"/>
			<input type="hidden" class="txt" id="getLastInfoUrl" data-edit="1" value="{getLastInfoUrl}"/>
			<input type="submit" class="txt_btn_a" onclick="auditEdit()" value="提交审批" />
			<input type="submit" class="txt_btn_a" value=" 保 存 " />
			<input type="button" class="txt_btn_a" onclick="closeFun();" value=" 取 消 " />
		</td>
	</tr>
</table>
</form>
</body>
</html>


